#include "helper.h"
#include <measuresuite.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>

const char symbol[] = {"fiat_p256_mul"};
const int arg_width = 4;
const int arg_num_in = 2;

int main() {
  SIGILL_SETUP();

  char fa[] = {
      "SECTION .text\n"
      "	GLOBAL mul_p256\n"
      "mul_p256:\n"
      "sub rsp, 0x150 ; last 0x30 (6) for Caller - save regs \n"
      "mov [ rsp + 0x120 ], rbx; saving to stack\n"
      "mov [ rsp + 0x128 ], rbp; saving to stack\n"
      "mov [ rsp + 0x130 ], r12; saving to stack\n"
      "mov [ rsp + 0x138 ], r13; saving to stack\n"
      "mov [ rsp + 0x140 ], r14; saving to stack\n"
      "mov [ rsp + 0x148 ], r15; saving to stack\n"
      "mov r11, [ rsi + 0x8 ]; load m64 x1 to register64\n"
      "xchg rdx, r11; x1, swapping with arg2, which is currently in rdx\n"
      "mulx r15, r13, [ r11 + 0x0 ]; x46, x45<- x1 * arg2[0]\n"
      "mulx r14, rcx, [ r11 + 0x8 ]; x44, x43<- x1 * arg2[1]\n"
      "mulx r8, r12, [ r11 + 0x10 ]; x42, x41<- x1 * arg2[2]\n"
      "test al, al\n"
      "adox rcx, r15\n"
      "mulx rdx, r10, [ r11 + 0x18 ]; x40, x39<- x1 * arg2[3]\n"
      "adox r12, r14\n"
      "adox r10, r8\n"
      "mov rax, 0x0 ; moving imm to reg\n"
      "adox rdx, rax\n"
      "mov r9, [ rsi + 0x0 ]; load m64 x4 to register64\n"
      "mov rbp, rdx; preserving value of x53 into a new reg\n"
      "mov rdx, [ r11 + 0x0 ]; saving arg2[0] in rdx.\n"
      "mulx rbx, r15, r9; x12, x11<- x4 * arg2[0]\n"
      "mov r14, 0xffffffffffffffff ; moving imm to reg\n"
      "mov rdx, r15; x11 to rdx\n"
      "mulx r15, r8, r14; x25, x24<- x11 * 0xffffffffffffffff\n"
      "mov rax, 0xffffffff ; moving imm to reg\n"
      "mov [ rsp + 0x0 ], r12; spilling x49 to mem\n"
      "mulx r14, r12, rax; x23, x22<- x11 * 0xffffffff\n"
      "adcx r12, r15\n"
      "adc r14, 0x0\n"
      "test al, al\n"
      "adox r8, rdx\n"
      "mov r8, rdx; preserving value of x11 into a new reg\n"
      "mov rdx, [ r11 + 0x8 ]; saving arg2[1] in rdx.\n"
      "mulx r15, rax, r9; x10, x9<- x4 * arg2[1]\n"
      "adcx rax, rbx\n"
      "adox r12, rax\n"
      "setc bl; spill CF x14 to reg (rbx)\n"
      "clc;\n"
      "adcx r13, r12\n"
      "mov rax, 0xffffffffffffffff ; moving imm to reg\n"
      "mov rdx, r13; x54 to rdx\n"
      "mulx r13, r12, rax; x69, x68<- x54 * 0xffffffffffffffff\n"
      "setc al; spill CF x55 to reg (rax)\n"
      "clc;\n"
      "adcx r12, rdx\n"
      "mov r12, rdx; preserving value of x54 into a new reg\n"
      "mov rdx, [ r11 + 0x10 ]; saving arg2[2] in rdx.\n"
      "mov [ rsp + 0x8 ], r10; spilling x51 to mem\n"
      "mov [ rsp + 0x10 ], rbp; spilling x53 to mem\n"
      "mulx r10, rbp, r9; x8, x7<- x4 * arg2[2]\n"
      "mov [ rsp + 0x18 ], r10; spilling x8 to mem\n"
      "setc r10b; spill CF x74 to reg (r10)\n"
      "clc;\n"
      "mov [ rsp + 0x20 ], rdi; spilling out1 to mem\n"
      "mov rdi, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adcx rbx, rdi; loading flag\n"
      "adcx r15, rbp\n"
      "adox r14, r15\n"
      "seto bl; spill OF x34 to reg (rbx)\n"
      "inc rdi; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "mov rbp, -0x1 ; moving imm to reg\n"
      "movzx rax, al\n"
      "adox rax, rbp; loading flag\n"
      "adox r14, rcx\n"
      "mov rcx, 0xffffffff ; moving imm to reg\n"
      "mov rdx, rcx; 0xffffffff to rdx\n"
      "mulx rcx, rax, r12; x67, x66<- x54 * 0xffffffff\n"
      "setc r15b; spill CF x16 to reg (r15)\n"
      "clc;\n"
      "adcx rax, r13\n"
      "seto r13b; spill OF x57 to reg (r13)\n"
      "dec rdi; OF<-0x0, preserve CF (debug: state 1(0x0) (thanks Paul))\n"
      "movzx r10, r10b\n"
      "adox r10, rdi; loading flag\n"
      "adox r14, rax\n"
      "mov rbp, [ rsi + 0x10 ]; load m64 x2 to register64\n"
      "mov r10, rdx; preserving value of 0xffffffff into a new reg\n"
      "mov rdx, [ r11 + 0x0 ]; saving arg2[0] in rdx.\n"
      "mulx rax, rdi, rbp; x91, x90<- x2 * arg2[0]\n"
      "setc r10b; spill CF x71 to reg (r10)\n"
      "clc;\n"
      "adcx rdi, r14\n"
      "mov r14, 0xffffffffffffffff ; moving imm to reg\n"
      "mov rdx, r14; 0xffffffffffffffff to rdx\n"
      "mov [ rsp + 0x28 ], rcx; spilling x67 to mem\n"
      "mulx r14, rcx, rdi; x114, x113<- x99 * 0xffffffffffffffff\n"
      "setc dl; spill CF x100 to reg (rdx)\n"
      "clc;\n"
      "adcx rcx, rdi\n"
      "xchg rdx, r9; x4, swapping with x100, which is currently in rdx\n"
      "mulx rdx, rcx, [ r11 + 0x18 ]; x6, x5<- x4 * arg2[3]\n"
      "mov [ rsp + 0x30 ], r14; spilling x114 to mem\n"
      "seto r14b; spill OF x76 to reg (r14)\n"
      "mov byte [ rsp + 0x38 ], bl; spilling byte x34 to mem\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "movzx r15, r15b\n"
      "adox r15, rbx; loading flag\n"
      "adox rcx, [ rsp + 0x18 ]\n"
      "mov r15, 0xffffffff00000001 ; moving imm to reg\n"
      "xchg rdx, r8; x11, swapping with x6, which is currently in rdx\n"
      "mulx rdx, rbx, r15; x21, x20<- x11 * 0xffffffff00000001\n"
      "seto r15b; spill OF x18 to reg (r15)\n"
      "mov [ rsp + 0x40 ], r8; spilling x6 to mem\n"
      "movzx r8, byte [ rsp + 0x38 ]; load byte memx34 to register64\n"
      "mov [ rsp + 0x48 ], rbp; spilling x2 to mem\n"
      "mov rbp, 0x0 ; moving imm to reg\n"
      "dec rbp; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "adox r8, rbp; loading flag\n"
      "adox rcx, rbx\n"
      "seto r8b; spill OF x36 to reg (r8)\n"
      "inc rbp; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "movzx r13, r13b\n"
      "adox r13, rbx; loading flag\n"
      "adox rcx, [ rsp + 0x0 ]\n"
      "movzx r13, r10b; x72, copying x71 here, cause x71 is needed in a reg "
      "for "
      "other than x72, namely all: , x72, size: 1\n"
      "mov rbp, [ rsp + 0x28 ]; load m64 x67 to register64\n"
      "lea r13, [ r13 + rbp ]; r8/64 + m8\n"
      "setc bpl; spill CF x119 to reg (rbp)\n"
      "clc;\n"
      "movzx r14, r14b\n"
      "adcx r14, rbx; loading flag\n"
      "adcx rcx, r13\n"
      "mov r10, rdx; preserving value of x21 into a new reg\n"
      "mov rdx, [ rsp + 0x48 ]; saving x2 in rdx.\n"
      "mulx r14, r13, [ r11 + 0x8 ]; x89, x88<- x2 * arg2[1]\n"
      "setc bl; spill CF x78 to reg (rbx)\n"
      "clc;\n"
      "adcx r13, rax\n"
      "setc al; spill CF x93 to reg (rax)\n"
      "clc;\n"
      "mov [ rsp + 0x48 ], rdx; spilling x2 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r9, r9b\n"
      "adcx r9, rdx; loading flag\n"
      "adcx rcx, r13\n"
      "mov r9, 0xffffffff ; moving imm to reg\n"
      "mov rdx, rdi; x99 to rdx\n"
      "mov [ rsp + 0x50 ], r10; spilling x21 to mem\n"
      "mulx r13, r10, r9; x112, x111<- x99 * 0xffffffff\n"
      "seto r9b; spill OF x59 to reg (r9)\n"
      "mov byte [ rsp + 0x58 ], r15b; spilling byte x18 to mem\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF   (debug: 6; load -2, increase it, save "
      "as "
      "-1)\n"
      "adox r10, [ rsp + 0x30 ]\n"
      "seto r15b; spill OF x116 to reg (r15)\n"
      "mov byte [ rsp + 0x60 ], r8b; spilling byte x36 to mem\n"
      "mov r8, -0x1 ; moving imm to reg\n"
      "inc r8; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r8, -0x1 ; moving imm to reg\n"
      "movzx rbp, bpl\n"
      "adox rbp, r8; loading flag\n"
      "adox rcx, r10\n"
      "mov rbp, [ rsi + 0x18 ]; load m64 x3 to register64\n"
      "mov r10, rdx; preserving value of x99 into a new reg\n"
      "mov rdx, [ r11 + 0x0 ]; saving arg2[0] in rdx.\n"
      "mov byte [ rsp + 0x68 ], r9b; spilling byte x59 to mem\n"
      "mulx r8, r9, rbp; x136, x135<- x3 * arg2[0]\n"
      "mov [ rsp + 0x70 ], r8; spilling x136 to mem\n"
      "seto r8b; spill OF x121 to reg (r8)\n"
      "mov [ rsp + 0x78 ], r11; spilling arg2 to mem\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF   (debug: 6; load -2, increase it, save "
      "as "
      "-1)\n"
      "adox r9, rcx\n"
      "mov rcx, 0xffffffffffffffff ; moving imm to reg\n"
      "mov rdx, r9; x144 to rdx\n"
      "mulx r9, r11, rcx; x159, x158<- x144 * 0xffffffffffffffff\n"
      "seto cl; spill OF x145 to reg (rcx)\n"
      "mov [ rsp + 0x80 ], r12; spilling x54 to mem\n"
      "mov r12, -0x2 ; moving imm to reg\n"
      "inc r12; OF<-0x0, preserve CF   (debug: 6; load -2, increase it, save "
      "as "
      "-1)\n"
      "adox r11, rdx\n"
      "movzx r11, byte [ rsp + 0x58 ]; x19, copying x18 here, cause x18 is "
      "needed in a reg for other than x19, namely all: , x19, size: 1\n"
      "mov r12, [ rsp + 0x40 ]; load m64 x6 to register64\n"
      "lea r11, [ r11 + r12 ]; r8/64 + m8\n"
      "seto r12b; spill OF x164 to reg (r12)\n"
      "mov byte [ rsp + 0x88 ], cl; spilling byte x145 to mem\n"
      "movzx rcx, byte [ rsp + 0x60 ]; load byte memx36 to register64\n"
      "mov byte [ rsp + 0x90 ], al; spilling byte x93 to mem\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "inc rax; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "adox rcx, rax; loading flag\n"
      "adox r11, [ rsp + 0x50 ]\n"
      "seto cl; spill OF x38 to reg (rcx)\n"
      "movzx rax, byte [ rsp + 0x68 ]; load byte memx59 to register64\n"
      "mov byte [ rsp + 0x98 ], r12b; spilling byte x164 to mem\n"
      "mov r12, 0x0 ; moving imm to reg\n"
      "dec r12; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "adox rax, r12; loading flag\n"
      "adox r11, [ rsp + 0x8 ]\n"
      "mov rax, 0xffffffff00000001 ; moving imm to reg\n"
      "mov r12, rdx; preserving value of x144 into a new reg\n"
      "mov rdx, [ rsp + 0x80 ]; saving x54 in rdx.\n"
      "mov [ rsp + 0xa0 ], r10; spilling x99 to mem\n"
      "mulx rdx, r10, rax; x65, x64<- x54 * 0xffffffff00000001\n"
      "seto al; spill OF x61 to reg (rax)\n"
      "mov [ rsp + 0xa8 ], rdx; spilling x65 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adox rbx, rdx; loading flag\n"
      "adox r11, r10\n"
      "mov rbx, [ rsp + 0x78 ]; load m64 arg2 to register64\n"
      "mov rdx, [ rbx + 0x10 ]; arg2[2] to rdx\n"
      "mov byte [ rsp + 0xb0 ], al; spilling byte x61 to mem\n"
      "mulx r10, rax, [ rsp + 0x48 ]; x87, x86<- x2 * arg2[2]\n"
      "mov [ rsp + 0xb8 ], r10; spilling x87 to mem\n"
      "seto r10b; spill OF x80 to reg (r10)\n"
      "mov [ rsp + 0x78 ], rbx; spilling arg2 to mem\n"
      "movzx rbx, byte [ rsp + 0x90 ]; load byte memx93 to register64\n"
      "mov [ rsp + 0xc0 ], rbp; spilling x3 to mem\n"
      "mov rbp, -0x1 ; moving imm to reg\n"
      "inc rbp; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rbp, -0x1 ; moving imm to reg\n"
      "adox rbx, rbp; loading flag\n"
      "adox r14, rax\n"
      "movzx rbx, r15b; x117, copying x116 here, cause x116 is needed in a reg "
      "for other than x117, namely all: , x117, size: 1\n"
      "lea rbx, [ rbx + r13 ]\n"
      "adcx r14, r11\n"
      "setc r13b; spill CF x104 to reg (r13)\n"
      "clc;\n"
      "movzx r8, r8b\n"
      "adcx r8, rbp; loading flag\n"
      "adcx r14, rbx\n"
      "mov r15, [ rsp + 0x78 ]; load m64 arg2 to register64\n"
      "mov rdx, [ r15 + 0x8 ]; arg2[1] to rdx\n"
      "mulx r8, r11, [ rsp + 0xc0 ]; x134, x133<- x3 * arg2[1]\n"
      "seto al; spill OF x95 to reg (rax)\n"
      "inc rbp; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "adox r11, [ rsp + 0x70 ]\n"
      "setc bl; spill CF x123 to reg (rbx)\n"
      "movzx rbp, byte [ rsp + 0x88 ]; load byte memx145 to register64\n"
      "clc;\n"
      "mov byte [ rsp + 0xc8 ], r13b; spilling byte x104 to mem\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "adcx rbp, r13; loading flag\n"
      "adcx r14, r11\n"
      "mov rbp, 0xffffffff ; moving imm to reg\n"
      "mov rdx, rbp; 0xffffffff to rdx\n"
      "mulx rbp, r11, r12; x157, x156<- x144 * 0xffffffff\n"
      "seto dl; spill OF x138 to reg (rdx)\n"
      "inc r13; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "adox r11, r9\n"
      "seto r9b; spill OF x161 to reg (r9)\n"
      "movzx r13, byte [ rsp + 0x98 ]; load byte memx164 to register64\n"
      "mov byte [ rsp + 0xd0 ], al; spilling byte x95 to mem\n"
      "mov rax, 0x0 ; moving imm to reg\n"
      "dec rax; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "adox r13, rax; loading flag\n"
      "adox r14, r11\n"
      "setc r13b; spill CF x147 to reg (r13)\n"
      "seto r11b; spill OF x166 to reg (r11)\n"
      "mov rax, r14; x174, copying x165 here, cause x165 is needed in a reg "
      "for "
      "other than x174, namely all: , x184, x174--x175, size: 2\n"
      "mov [ rsp + 0xd8 ], rbp; spilling x157 to mem\n"
      "mov rbp, 0xffffffffffffffff ; moving imm to reg\n"
      "sub rax, rbp\n"
      "movzx rbp, cl; x62, copying x38 here, cause x38 is needed in a reg for "
      "other than x62, namely all: , x62--x63, size: 1\n"
      "mov [ rsp + 0xe0 ], r14; spilling x165 to mem\n"
      "movzx r14, byte [ rsp + 0xb0 ]; load byte memx61 to register64\n"
      "mov byte [ rsp + 0xe8 ], r11b; spilling byte x166 to mem\n"
      "mov r11, -0x1 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r11, -0x1 ; moving imm to reg\n"
      "adox r14, r11; loading flag\n"
      "adox rbp, [ rsp + 0x10 ]\n"
      "setc cl; spill CF x175 to reg (rcx)\n"
      "clc;\n"
      "movzx r10, r10b\n"
      "adcx r10, r11; loading flag\n"
      "adcx rbp, [ rsp + 0xa8 ]\n"
      "mov r14b, dl; preserving value of x138 into a new reg\n"
      "mov rdx, [ r15 + 0x18 ]; saving arg2[3] in rdx.\n"
      "mulx r10, r11, [ rsp + 0x48 ]; x85, x84<- x2 * arg2[3]\n"
      "mov [ rsp + 0xf0 ], r10; spilling x85 to mem\n"
      "setc r10b; spill CF x82 to reg (r10)\n"
      "mov byte [ rsp + 0xf8 ], r13b; spilling byte x147 to mem\n"
      "movzx r13, byte [ rsp + 0xd0 ]; load byte memx95 to register64\n"
      "clc;\n"
      "mov [ rsp + 0x78 ], r15; spilling arg2 to mem\n"
      "mov r15, -0x1 ; moving imm to reg\n"
      "adcx r13, r15; loading flag\n"
      "adcx r11, [ rsp + 0xb8 ]\n"
      "mov r13, 0xffffffff00000001 ; moving imm to reg\n"
      "mov rdx, r13; 0xffffffff00000001 to rdx\n"
      "mulx r13, r15, [ rsp + 0xa0 ]; x110, x109<- x99 * 0xffffffff00000001\n"
      "seto dl; spill OF x63 to reg (rdx)\n"
      "mov [ rsp + 0x100 ], r13; spilling x110 to mem\n"
      "movzx r13, byte [ rsp + 0xc8 ]; load byte memx104 to register64\n"
      "mov byte [ rsp + 0x108 ], r10b; spilling byte x82 to mem\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "adox r13, r10; loading flag\n"
      "adox rbp, r11\n"
      "seto r13b; spill OF x106 to reg (r13)\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "mov r11, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adox rbx, r11; loading flag\n"
      "adox rbp, r15\n"
      "mov rbx, [ rsp + 0x78 ]; load m64 arg2 to register64\n"
      "mov r15b, dl; preserving value of x63 into a new reg\n"
      "mov rdx, [ rsp + 0xc0 ]; saving x3 in rdx.\n"
      "mulx r10, r11, [ rbx + 0x10 ]; x132, x131<- x3 * arg2[2]\n"
      "mov [ rsp + 0x78 ], rbx; spilling arg2 to mem\n"
      "seto bl; spill OF x125 to reg (rbx)\n"
      "mov [ rsp + 0xc0 ], rdx; spilling x3 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r14, r14b\n"
      "adox r14, rdx; loading flag\n"
      "adox r8, r11\n"
      "movzx r14, r9b; x162, copying x161 here, cause x161 is needed in a reg "
      "for other than x162, namely all: , x162, size: 1\n"
      "mov r11, [ rsp + 0xd8 ]; load m64 x157 to register64\n"
      "lea r14, [ r14 + r11 ]; r8/64 + m8\n"
      "setc r11b; spill CF x97 to reg (r11)\n"
      "movzx r9, byte [ rsp + 0xf8 ]; load byte memx147 to register64\n"
      "clc;\n"
      "adcx r9, rdx; loading flag\n"
      "adcx rbp, r8\n"
      "seto r9b; spill OF x140 to reg (r9)\n"
      "movzx r8, byte [ rsp + 0xe8 ]; load byte memx166 to register64\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "adox r8, rdx; loading flag\n"
      "adox rbp, r14\n"
      "setc r8b; spill CF x149 to reg (r8)\n"
      "seto r14b; spill OF x168 to reg (r14)\n"
      "movzx rdx, cl; x175, copying x175 here, cause x175 is needed in a reg "
      "for "
      "other than x175, namely all: , x176--x177, size: 1\n"
      "add rdx, -0x1\n"
      "mov rcx, rbp; x176, copying x167 here, cause x167 is needed in a reg "
      "for "
      "other than x176, namely all: , x176--x177, x185, size: 2\n"
      "mov [ rsp + 0x110 ], rax; spilling x174 to mem\n"
      "mov rax, 0xffffffff ; moving imm to reg\n"
      "sbb rcx, rax\n"
      "movzx rax, r15b; x83, copying x63 here, cause x63 is needed in a reg "
      "for "
      "other than x83, namely all: , x83, size: 1\n"
      "mov [ rsp + 0x118 ], rcx; spilling x176 to mem\n"
      "movzx rcx, byte [ rsp + 0x108 ]; load byte memx82 to register64\n"
      "lea rax, [ rax + rcx ]; r64+m8\n"
      "movzx r15, r11b; x98, copying x97 here, cause x97 is needed in a reg "
      "for "
      "other than x98, namely all: , x98, size: 1\n"
      "mov rcx, [ rsp + 0xf0 ]; load m64 x85 to register64\n"
      "lea r15, [ r15 + rcx ]; r8/64 + m8\n"
      "mov rcx, 0x0 ; moving imm to reg\n"
      "dec rcx; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "movzx r13, r13b\n"
      "adox r13, rcx; loading flag\n"
      "adox rax, r15\n"
      "seto r11b; spill OF x108 to reg (r11)\n"
      "inc rcx; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adox rbx, r13; loading flag\n"
      "adox rax, [ rsp + 0x100 ]\n"
      "mov rbx, [ rsp + 0x78 ]; load m64 arg2 to register64\n"
      "mov rdx, [ rsp + 0xc0 ]; x3 to rdx\n"
      "mulx rdx, r15, [ rbx + 0x18 ]; x130, x129<- x3 * arg2[3]\n"
      "setc cl; spill CF x177 to reg (rcx)\n"
      "clc;\n"
      "movzx r9, r9b\n"
      "adcx r9, r13; loading flag\n"
      "adcx r10, r15\n"
      "mov r9, 0xffffffff00000001 ; moving imm to reg\n"
      "xchg rdx, r9; 0xffffffff00000001, swapping with x130, which is "
      "currently "
      "in rdx\n"
      "mulx r12, r15, r12; x155, x154<- x144 * 0xffffffff00000001\n"
      "seto r13b; spill OF x127 to reg (r13)\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r8, r8b\n"
      "adox r8, rdx; loading flag\n"
      "adox rax, r10\n"
      "seto r8b; spill OF x151 to reg (r8)\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx r14, r14b\n"
      "adox r14, r10; loading flag\n"
      "adox rax, r15\n"
      "setc r14b; spill CF x142 to reg (r14)\n"
      "seto r15b; spill OF x170 to reg (r15)\n"
      "movzx r10, cl; x177, copying x177 here, cause x177 is needed in a reg "
      "for "
      "other than x177, namely all: , x178--x179, size: 1\n"
      "add r10, -0x1\n"
      "mov r10, rax; x178, copying x169 here, cause x169 is needed in a reg "
      "for "
      "other than x178, namely all: , x186, x178--x179, size: 2\n"
      "sbb r10, 0x00000000\n"
      "movzx rcx, r13b; x128, copying x127 here, cause x127 is needed in a reg "
      "for other than x128, namely all: , x128, size: 1\n"
      "movzx r11, r11b\n"
      "lea rcx, [ rcx + r11 ]\n"
      "movzx r11, r14b; x143, copying x142 here, cause x142 is needed in a reg "
      "for other than x143, namely all: , x143, size: 1\n"
      "lea r11, [ r11 + r9 ]\n"
      "dec rdx; OF<-0x0, preserve CF (debug: state 3 (y: 0, n: -1))\n"
      "movzx r8, r8b\n"
      "adox r8, rdx; loading flag\n"
      "adox rcx, r11\n"
      "seto r13b; spill OF x153 to reg (r13)\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 2 (y: -1, n: 0))\n"
      "mov r9, -0x1 ; moving imm to reg\n"
      "movzx r15, r15b\n"
      "adox r15, r9; loading flag\n"
      "adox rcx, r12\n"
      "movzx r14, r13b; x173, copying x153 here, cause x153 is needed in a reg "
      "for other than x173, namely all: , x173, size: 1\n"
      "adox r14, rdx\n"
      "mov r12, rcx; x180, copying x171 here, cause x171 is needed in a reg "
      "for "
      "other than x180, namely all: , x180--x181, x187, size: 2\n"
      "mov r8, 0xffffffff00000001 ; moving imm to reg\n"
      "sbb r12, r8\n"
      "sbb r14, 0x00000000\n"
      "cmovc r10, rax; if CF, x186<- x169 (nzVar)\n"
      "mov r14, [ rsp + 0x118 ]; x185, copying x176 here, cause x176 is needed "
      "in a reg for other than x185, namely all: , x185, size: 1\n"
      "cmovc r14, rbp; if CF, x185<- x167 (nzVar)\n"
      "mov rbp, [ rsp + 0x20 ]; load m64 out1 to register64\n"
      "mov [ rbp + 0x8 ], r14; out1[1] = x185\n"
      "mov rax, [ rsp + 0x110 ]; x184, copying x174 here, cause x174 is needed "
      "in a reg for other than x184, namely all: , x184, size: 1\n"
      "cmovc rax, [ rsp + 0xe0 ]; if CF, x184<- x165 (nzVar)\n"
      "mov [ rbp + 0x0 ], rax; out1[0] = x184\n"
      "mov [ rbp + 0x10 ], r10; out1[2] = x186\n"
      "cmovc r12, rcx; if CF, x187<- x171 (nzVar)\n"
      "mov [ rbp + 0x18 ], r12; out1[3] = x187\n"
      "mov rbx, [ rsp + 0x120 ]; restoring from stack\n"
      "mov rbp, [ rsp + 0x128 ]; restoring from stack\n"
      "mov r12, [ rsp + 0x130 ]; restoring from stack\n"
      "mov r13, [ rsp + 0x138 ]; restoring from stack\n"
      "mov r14, [ rsp + 0x140 ]; restoring from stack\n"
      "mov r15, [ rsp + 0x148 ]; restoring from stack\n"
      "add rsp, 0x150 \n"
      "ret\n"
      "; cpu Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz\n"
      "; clocked at 1800 MHz\n"
      "; first cyclecount 7326, last 5803.5\n"
      "; seed 1617344369 \n"
      "; time needed: 2560 ms / 100 runs=> 25.6ms/run\n"
      "; Time spent for assembling and measureing (r=200,e=100): 406 ms\n"
      "; Ratio (time for assembling + measure)/(total runtime for 100runs): "
      "0.15859375\n"
      "; number reverted permutation/ tried permutation: 26 / 37 =70.270%\n"
      "; number reverted spill/ tried spill: 18 / 26 =69.231%\n"
      "; number reverted decision/ tried decision: 17 / 36 =47.222%\n"
      "; FailedEvals (cannot swap because of edge to the next node): 47\n"};

  char fb[] = {
      "SECTION .text\n"
      "	GLOBAL mul_p256\n"
      "mul_p256:\n"
      "sub rsp, 0x160 \n"
      "mov [ rsp + 0x128 ], rbx; saving to stack\n"
      "mov [ rsp + 0x130 ], rbp; saving to stack\n"
      "mov [ rsp + 0x138 ], r12; saving to stack\n"
      "mov [ rsp + 0x140 ], r13; saving to stack\n"
      "mov [ rsp + 0x148 ], r14; saving to stack\n"
      "mov [ rsp + 0x150 ], r15; saving to stack\n"
      "mov rbx, [ rsi + 0x0 ]; load m64 x4 to register64\n"
      "mov r14, rdx; preserving value of arg2 into a new reg\n"
      "mov rdx, [ rdx + 0x0 ]; saving arg2[0] in rdx.\n"
      "mulx rbp, r9, rbx; x12, x11<- x4 * arg2[0]\n"
      "mov rdx, rbx; x4 to rdx\n"
      "mulx r11, rbx, [ r14 + 0x8 ]; x10, x9<- x4 * arg2[1]\n"
      "mov rcx, 0xffffffffffffffff ; moving imm to reg\n"
      "xchg rdx, rcx; 0xffffffffffffffff, swapping with x4, which is currently "
      "in rdx\n"
      "mulx rax, r15, r9; x25, x24<- x11 * 0xffffffffffffffff\n"
      "mov r13, [ rsi + 0x18 ]; load m64 x3 to register64\n"
      "mov r10, rdx; preserving value of 0xffffffffffffffff into a new reg\n"
      "mov rdx, [ r14 + 0x0 ]; saving arg2[0] in rdx.\n"
      "mulx r8, r12, r13; x136, x135<- x3 * arg2[0]\n"
      "mov rdx, [ r14 + 0x18 ]; arg2[3] to rdx\n"
      "mov [ rsp + 0x0 ], r9; spilling x11 to mem\n"
      "mulx r10, r9, r13; x130, x129<- x3 * arg2[3]\n"
      "mov rdx, r13; x3 to rdx\n"
      "mov [ rsp + 0x8 ], rsi; spilling arg1 to mem\n"
      "mulx r13, rsi, [ r14 + 0x10 ]; x132, x131<- x3 * arg2[2]\n"
      "mov [ rsp + 0x10 ], rdi; spilling out1 to mem\n"
      "xor rdi, rdi\n"
      "adox r15, [ rsp + 0x0 ]\n"
      "mulx rdx, r15, [ r14 + 0x8 ]; x134, x133<- x3 * arg2[1]\n"
      "adcx r15, r8\n"
      "adcx rsi, rdx\n"
      "adcx r9, r13\n"
      "mov r8, 0xffffffff ; moving imm to reg\n"
      "mov rdx, r8; 0xffffffff to rdx\n"
      "mulx r8, r13, [ rsp + 0x0 ]; x23, x22<- x11 * 0xffffffff\n"
      "seto dl; spill OF x30 to reg (rdx)\n"
      "mov [ rsp + 0x18 ], r15; spilling x137 to mem\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r13, rax\n"
      "mov r15, [ rsp + 0x8 ]; load m64 arg1 to register64\n"
      "mov rax, [ r15 + 0x8 ]; load m64 x1 to register64\n"
      "adcx r10, rdi\n"
      "mov rdi, [ r15 + 0x10 ]; load m64 x2 to register64\n"
      "clc;\n"
      "adcx rbx, rbp\n"
      "setc bpl; spill CF x14 to reg (rbp)\n"
      "clc;\n"
      "mov [ rsp + 0x20 ], rax; spilling x1 to mem\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "movzx rdx, dl\n"
      "adcx rdx, rax; loading flag\n"
      "adcx rbx, r13\n"
      "mov rdx, [ rsp + 0x20 ]; x1 to rdx\n"
      "mulx r13, rax, [ r14 + 0x8 ]; x44, x43<- x1 * arg2[1]\n"
      "mov [ rsp + 0x8 ], r15; spilling arg1 to mem\n"
      "mov [ rsp + 0x28 ], rsi; spilling x139 to mem\n"
      "mulx r15, rsi, [ r14 + 0x0 ]; x46, x45<- x1 * arg2[0]\n"
      "mov [ rsp + 0x20 ], rdx; spilling x1 to mem\n"
      "seto dl; spill OF x27 to reg (rdx)\n"
      "mov [ rsp + 0x30 ], r15; spilling x46 to mem\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rsi, rbx\n"
      "seto r15b; spill OF x55 to reg (r15)\n"
      "mov rbx, -0x2 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rax, [ rsp + 0x30 ]\n"
      "mov bl, dl; preserving value of x27 into a new reg\n"
      "mov rdx, [ r14 + 0x18 ]; saving arg2[3] in rdx.\n"
      "mov [ rsp + 0x38 ], r9; spilling x141 to mem\n"
      "mov [ rsp + 0x40 ], rsi; spilling x54 to mem\n"
      "mulx r9, rsi, rcx; x6, x5<- x4 * arg2[3]\n"
      "mov [ rsp + 0x48 ], r9; spilling x6 to mem\n"
      "mov r9, 0xffffffffffffffff ; moving imm to reg\n"
      "mov rdx, [ rsp + 0x40 ]; x54 to rdx\n"
      "mov [ rsp + 0x50 ], r8; spilling x23 to mem\n"
      "mov [ rsp + 0x58 ], r10; spilling x143 to mem\n"
      "mulx r8, r10, r9; x69, x68<- x54 * 0xffffffffffffffff\n"
      "mov r9, rdx; preserving value of x54 into a new reg\n"
      "mov rdx, [ r14 + 0x10 ]; saving arg2[2] in rdx.\n"
      "mov [ rsp + 0x60 ], rax; spilling x47 to mem\n"
      "mulx rcx, rax, rcx; x8, x7<- x4 * arg2[2]\n"
      "mov [ rsp + 0x40 ], r9; spilling x54 to mem\n"
      "seto r9b; spill OF x48 to reg (r9)\n"
      "mov [ rsp + 0x68 ], rcx; spilling x8 to mem\n"
      "mov rcx, -0x1 ; moving imm to reg\n"
      "inc rcx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rcx, -0x2 ; moving imm to reg\n"
      "inc rcx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov rcx, -0x1 ; moving imm to reg\n"
      "movzx rbp, bpl\n"
      "adox rbp, rcx; loading flag\n"
      "adox r11, rax\n"
      "movzx rbp, bl; x28, copying x27 here, cause x27 is needed in a reg for "
      "other than x28, namely all: , x28, size: 1\n"
      "mov rax, [ rsp + 0x50 ]; load m64 x23 to register64\n"
      "lea rbp, [ rbp + rax ]; r8/64 + m8\n"
      "adcx rbp, r11\n"
      "mov rax, 0xffffffff ; moving imm to reg\n"
      "mov rdx, rax; 0xffffffff to rdx\n"
      "mulx rax, rbx, [ rsp + 0x40 ]; x67, x66<- x54 * 0xffffffff\n"
      "mov r11, [ rsp + 0x68 ]; x17, copying x8 here, cause x8 is needed in a "
      "reg for other than x17, namely all: , x17--x18, size: 1\n"
      "adox r11, rsi\n"
      "setc sil; spill CF x34 to reg (rsi)\n"
      "clc;\n"
      "movzx r15, r15b\n"
      "adcx r15, rcx; loading flag\n"
      "adcx rbp, [ rsp + 0x60 ]\n"
      "seto r15b; spill OF x18 to reg (r15)\n"
      "inc rcx; OF<-0x0, preserve CF (debug: state 2)\n"
      "adox rbx, r8\n"
      "seto r8b; spill OF x71 to reg (r8)\n"
      "mov rdx, -0x2 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, [ rsp + 0x40 ]\n"
      "mov rdx, rdi; x2 to rdx\n"
      "mulx r10, rcx, [ r14 + 0x0 ]; x91, x90<- x2 * arg2[0]\n"
      "mov [ rsp + 0x70 ], rcx; spilling x90 to mem\n"
      "movzx rcx, r8b; x72, copying x71 here, cause x71 is needed in a reg for "
      "other than x72, namely all: , x72, size: 1\n"
      "lea rcx, [ rcx + rax ]\n"
      "adox rbx, rbp\n"
      "mulx rax, rbp, [ r14 + 0x8 ]; x89, x88<- x2 * arg2[1]\n"
      "movzx r8, r15b; x19, copying x18 here, cause x18 is needed in a reg for "
      "other than x19, namely all: , x19, size: 1\n"
      "mov byte [ rsp + 0x78 ], sil; spilling byte x34 to mem\n"
      "mov rsi, [ rsp + 0x48 ]; load m64 x6 to register64\n"
      "lea r8, [ r8 + rsi ]; r8/64 + m8\n"
      "mov rsi, 0xffffffff00000001 ; moving imm to reg\n"
      "xchg rdx, rsi; 0xffffffff00000001, swapping with x2, which is currently "
      "in rdx\n"
      "mov [ rsp + 0x80 ], rbp; spilling x88 to mem\n"
      "mulx r15, rbp, [ rsp + 0x0 ]; x21, x20<- x11 * 0xffffffff00000001\n"
      "setc dl; spill CF x57 to reg (rdx)\n"
      "mov [ rsp + 0x88 ], r15; spilling x21 to mem\n"
      "movzx r15, byte [ rsp + 0x78 ]; load byte memx34 to register64\n"
      "clc;\n"
      "mov [ rsp + 0x90 ], rax; spilling x89 to mem\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "adcx r15, rax; loading flag\n"
      "adcx r11, rbp\n"
      "mov r15b, dl; preserving value of x57 into a new reg\n"
      "mov rdx, [ rsp + 0x20 ]; saving x1 in rdx.\n"
      "mulx rbp, rax, [ r14 + 0x10 ]; x42, x41<- x1 * arg2[2]\n"
      "mov [ rsp + 0x20 ], rdx; spilling x1 to mem\n"
      "mov rdx, [ rsp + 0x88 ]; x37, copying x21 here, cause x21 is needed in "
      "a "
      "reg for other than x37, namely all: , x37--x38, size: 1\n"
      "adcx rdx, r8\n"
      "setc r8b; spill CF x38 to reg (r8)\n"
      "clc;\n"
      "adcx rbx, [ rsp + 0x70 ]\n"
      "mov [ rsp + 0x98 ], rbp; spilling x42 to mem\n"
      "mov rbp, rdx; preserving value of x37 into a new reg\n"
      "mov rdx, [ rsp + 0x20 ]; saving x1 in rdx.\n"
      "mov [ rsp + 0xa0 ], rax; spilling x41 to mem\n"
      "mulx rdx, rax, [ r14 + 0x18 ]; x40, x39<- x1 * arg2[3]\n"
      "mov [ rsp + 0xa8 ], rbx; spilling x99 to mem\n"
      "setc bl; spill CF x100 to reg (rbx)\n"
      "clc;\n"
      "mov [ rsp + 0xb0 ], rdx; spilling x40 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r9, r9b\n"
      "adcx r9, rdx; loading flag\n"
      "adcx r13, [ rsp + 0xa0 ]\n"
      "seto r9b; spill OF x76 to reg (r9)\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r15, r15b\n"
      "adox r15, rdx; loading flag\n"
      "adox r11, r13\n"
      "setc r15b; spill CF x50 to reg (r15)\n"
      "clc;\n"
      "movzx r9, r9b\n"
      "adcx r9, rdx; loading flag\n"
      "adcx r11, rcx\n"
      "setc cl; spill CF x78 to reg (rcx)\n"
      "clc;\n"
      "adcx r10, [ rsp + 0x80 ]\n"
      "seto r9b; spill OF x59 to reg (r9)\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "movzx r15, r15b\n"
      "adox r15, r13; loading flag\n"
      "adox rax, [ rsp + 0x98 ]\n"
      "mov r15, 0xffffffffffffffff ; moving imm to reg\n"
      "mov r13, rdx; preserving value of 0x0 into a new reg\n"
      "mov rdx, [ rsp + 0xa8 ]; saving x99 in rdx.\n"
      "mov byte [ rsp + 0xb8 ], r9b; spilling byte x59 to mem\n"
      "mov byte [ rsp + 0xc0 ], cl; spilling byte x78 to mem\n"
      "mulx r9, rcx, r15; x114, x113<- x99 * 0xffffffffffffffff\n"
      "mov r13, 0xffffffff ; moving imm to reg\n"
      "mov [ rsp + 0xc8 ], r9; spilling x114 to mem\n"
      "mulx r15, r9, r13; x112, x111<- x99 * 0xffffffff\n"
      "setc r13b; spill CF x93 to reg (r13)\n"
      "clc;\n"
      "mov [ rsp + 0xa8 ], rdx; spilling x99 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adcx rbx, rdx; loading flag\n"
      "adcx r11, r10\n"
      "mov rbx, 0xffffffff00000001 ; moving imm to reg\n"
      "mov rdx, rbx; 0xffffffff00000001 to rdx\n"
      "mulx rbx, r10, [ rsp + 0x40 ]; x65, x64<- x54 * 0xffffffff00000001\n"
      "seto dl; spill OF x52 to reg (rdx)\n"
      "mov [ rsp + 0xd0 ], rbx; spilling x65 to mem\n"
      "mov rbx, -0x2 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r9, [ rsp + 0xc8 ]\n"
      "movzx rbx, dl; x53, copying x52 here, cause x52 is needed in a reg for "
      "other than x53, namely all: , x53, size: 1\n"
      "mov [ rsp + 0xd8 ], rcx; spilling x113 to mem\n"
      "mov rcx, [ rsp + 0xb0 ]; load m64 x40 to register64\n"
      "lea rbx, [ rbx + rcx ]; r8/64 + m8\n"
      "mov rcx, [ rsp + 0xa8 ]; load m64 x99 to register64\n"
      "mov rdx, rcx; _, copying x99 here, cause x99 is needed in a reg for "
      "other "
      "than _, namely all: , _--x119, x109--x110, size: 2\n"
      "mov [ rsp + 0xe0 ], r10; spilling x64 to mem\n"
      "seto r10b; spill OF x116 to reg (r10)\n"
      "mov [ rsp + 0xe8 ], rsi; spilling x2 to mem\n"
      "mov rsi, -0x2 ; moving imm to reg\n"
      "inc rsi; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rdx, [ rsp + 0xd8 ]\n"
      "adox r9, r11\n"
      "seto r11b; spill OF x121 to reg (r11)\n"
      "mov [ rsp + 0xa8 ], rcx; spilling x99 to mem\n"
      "movzx rcx, byte [ rsp + 0xb8 ]; load byte memx59 to register64\n"
      "mov byte [ rsp + 0xf0 ], r8b; spilling byte x38 to mem\n"
      "mov r8, 0x0 ; moving imm to reg\n"
      "dec r8; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "mov r8, -0x2 ; moving imm to reg\n"
      "inc r8; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r8, -0x1 ; moving imm to reg\n"
      "adox rcx, r8; loading flag\n"
      "adox rbp, rax\n"
      "seto cl; spill OF x61 to reg (rcx)\n"
      "inc r8; OF<-0x0, preserve CF (debug: state 2)\n"
      "adox r12, r9\n"
      "seto al; spill OF x145 to reg (rax)\n"
      "dec r8; OF<-0x0, preserve CF (debug: state 3)\n"
      "movzx r9, byte [ rsp + 0xf0 ]; load byte memx38 to register64\n"
      "movzx rcx, cl\n"
      "adox rcx, r8; loading flag\n"
      "adox rbx, r9\n"
      "mov rdx, [ r14 + 0x10 ]; arg2[2] to rdx\n"
      "mulx r9, rcx, [ rsp + 0xe8 ]; x87, x86<- x2 * arg2[2]\n"
      "mov rdx, [ rsp + 0xe8 ]; x2 to rdx\n"
      "mulx rdx, r8, [ r14 + 0x18 ]; x85, x84<- x2 * arg2[3]\n"
      "mov byte [ rsp + 0xf8 ], al; spilling byte x145 to mem\n"
      "mov rax, 0xffffffff ; moving imm to reg\n"
      "xchg rdx, r12; x144, swapping with x85, which is currently in rdx\n"
      "mov [ rsp + 0x100 ], rcx; spilling x86 to mem\n"
      "mov [ rsp + 0x108 ], r9; spilling x87 to mem\n"
      "mulx rcx, r9, rax; x157, x156<- x144 * 0xffffffff\n"
      "movzx rax, r10b; x117, copying x116 here, cause x116 is needed in a reg "
      "for other than x117, namely all: , x117, size: 1\n"
      "lea rax, [ rax + r15 ]\n"
      "mov r15, [ rsp + 0x100 ]; load m64 x86 to register64\n"
      "setc r10b; spill CF x102 to reg (r10)\n"
      "clc;\n"
      "mov [ rsp + 0x110 ], rdx; spilling x144 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r13, r13b\n"
      "adcx r13, rdx; loading flag\n"
      "adcx r15, [ rsp + 0x90 ]\n"
      "setc r13b; spill CF x95 to reg (r13)\n"
      "movzx rdx, byte [ rsp + 0xc0 ]; load byte memx78 to register64\n"
      "clc;\n"
      "mov [ rsp + 0x118 ], rcx; spilling x157 to mem\n"
      "mov rcx, -0x1 ; moving imm to reg\n"
      "adcx rdx, rcx; loading flag\n"
      "adcx rbp, [ rsp + 0xe0 ]\n"
      "mov rdx, [ rsp + 0xd0 ]; x81, copying x65 here, cause x65 is needed in "
      "a "
      "reg for other than x81, namely all: , x81--x82, size: 1\n"
      "adcx rdx, rbx\n"
      "seto bl; spill OF x63 to reg (rbx)\n"
      "inc rcx; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rcx, -0x1 ; moving imm to reg\n"
      "movzx r10, r10b\n"
      "adox r10, rcx; loading flag\n"
      "adox rbp, r15\n"
      "setc r10b; spill CF x82 to reg (r10)\n"
      "clc;\n"
      "movzx r13, r13b\n"
      "adcx r13, rcx; loading flag\n"
      "adcx r8, [ rsp + 0x108 ]\n"
      "mov r15, 0x0 ; moving imm to reg\n"
      "adcx r12, r15\n"
      "adox r8, rdx\n"
      "mov r13, 0xffffffffffffffff ; moving imm to reg\n"
      "mov rdx, r13; 0xffffffffffffffff to rdx\n"
      "mulx r13, r15, [ rsp + 0x110 ]; x159, x158<- x144 * 0xffffffffffffffff\n"
      "movzx rdx, r10b; x83, copying x82 here, cause x82 is needed in a reg "
      "for "
      "other than x83, namely all: , x83, size: 1\n"
      "movzx rbx, bl\n"
      "lea rdx, [ rdx + rbx ]\n"
      "clc;\n"
      "adcx r9, r13\n"
      "seto bl; spill OF x106 to reg (rbx)\n"
      "inc rcx; OF<-0x0, preserve CF (debug: state 2)\n"
      "adox r15, [ rsp + 0x110 ]\n"
      "setc r15b; spill CF x161 to reg (r15)\n"
      "clc;\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx r11, r11b\n"
      "adcx r11, r10; loading flag\n"
      "adcx rbp, rax\n"
      "mov r11, 0xffffffff00000001 ; moving imm to reg\n"
      "xchg rdx, r11; 0xffffffff00000001, swapping with x83, which is "
      "currently "
      "in rdx\n"
      "mulx rax, r13, [ rsp + 0x110 ]; x155, x154<- x144 * 0xffffffff00000001\n"
      "mulx rcx, r10, [ rsp + 0xa8 ]; x110, x109<- x99 * 0xffffffff00000001\n"
      "setc dl; spill CF x123 to reg (rdx)\n"
      "clc;\n"
      "mov byte [ rsp + 0x120 ], r15b; spilling byte x161 to mem\n"
      "mov r15, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adcx rbx, r15; loading flag\n"
      "adcx r11, r12\n"
      "setc r12b; spill CF x108 to reg (r12)\n"
      "clc;\n"
      "movzx rdx, dl\n"
      "adcx rdx, r15; loading flag\n"
      "adcx r8, r10\n"
      "adcx rcx, r11\n"
      "seto bl; spill OF x164 to reg (rbx)\n"
      "movzx rdx, byte [ rsp + 0xf8 ]; load byte memx145 to register64\n"
      "inc r15; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "adox rdx, r10; loading flag\n"
      "adox rbp, [ rsp + 0x18 ]\n"
      "setc dl; spill CF x127 to reg (rdx)\n"
      "clc;\n"
      "movzx rbx, bl\n"
      "adcx rbx, r10; loading flag\n"
      "adcx rbp, r9\n"
      "setc r9b; spill CF x166 to reg (r9)\n"
      "seto bl; spill OF x147 to reg (rbx)\n"
      "mov r11, rbp; x174, copying x165 here, cause x165 is needed in a reg "
      "for "
      "other than x174, namely all: , x174--x175, x184, size: 2\n"
      "mov r10, 0xffffffffffffffff ; moving imm to reg\n"
      "sub r11, r10\n"
      "dec r15; OF<-0x0, preserve CF (debug: state 3)\n"
      "movzx rbx, bl\n"
      "adox rbx, r15; loading flag\n"
      "adox r8, [ rsp + 0x28 ]\n"
      "movzx rbx, byte [ rsp + 0x120 ]; x162, copying x161 here, cause x161 is "
      "needed in a reg for other than x162, namely all: , x162, size: 1\n"
      "mov r10, [ rsp + 0x118 ]; load m64 x157 to register64\n"
      "lea rbx, [ rbx + r10 ]; r8/64 + m8\n"
      "setc r10b; spill CF x175 to reg (r10)\n"
      "clc;\n"
      "movzx r9, r9b\n"
      "adcx r9, r15; loading flag\n"
      "adcx r8, rbx\n"
      "mov r9, [ rsp + 0x38 ]; x150, copying x141 here, cause x141 is needed "
      "in "
      "a reg for other than x150, namely all: , x150--x151, size: 1\n"
      "adox r9, rcx\n"
      "movzx rcx, dl; x128, copying x127 here, cause x127 is needed in a reg "
      "for "
      "other than x128, namely all: , x128, size: 1\n"
      "movzx r12, r12b\n"
      "lea rcx, [ rcx + r12 ]\n"
      "mov r12, [ rsp + 0x58 ]; x152, copying x143 here, cause x143 is needed "
      "in "
      "a reg for other than x152, namely all: , x152--x153, size: 1\n"
      "adox r12, rcx\n"
      "adcx r13, r9\n"
      "setc dl; spill CF x170 to reg (rdx)\n"
      "seto bl; spill OF x153 to reg (rbx)\n"
      "movzx r9, r10b; x175, copying x175 here, cause x175 is needed in a reg "
      "for other than x175, namely all: , x176--x177, size: 1\n"
      "add r9, -0x1\n"
      "mov r10, r8; x176, copying x167 here, cause x167 is needed in a reg for "
      "other than x176, namely all: , x176--x177, x185, size: 2\n"
      "mov r9, 0xffffffff ; moving imm to reg\n"
      "sbb r10, r9\n"
      "mov rcx, r13; x178, copying x169 here, cause x169 is needed in a reg "
      "for "
      "other than x178, namely all: , x186, x178--x179, size: 2\n"
      "sbb rcx, 0x00000000\n"
      "inc r15; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r15, -0x1 ; moving imm to reg\n"
      "movzx rdx, dl\n"
      "adox rdx, r15; loading flag\n"
      "adox r12, rax\n"
      "movzx rax, bl; x173, copying x153 here, cause x153 is needed in a reg "
      "for "
      "other than x173, namely all: , x173, size: 1\n"
      "mov rdx, 0x0 ; moving imm to reg\n"
      "adox rax, rdx\n"
      "mov rbx, r12; x180, copying x171 here, cause x171 is needed in a reg "
      "for "
      "other than x180, namely all: , x187, x180--x181, size: 2\n"
      "mov rdx, 0xffffffff00000001 ; moving imm to reg\n"
      "sbb rbx, rdx\n"
      "sbb rax, 0x00000000\n"
      "cmovc r10, r8; if CF, x185<- x167 (nzVar)\n"
      "cmovc rcx, r13; if CF, x186<- x169 (nzVar)\n"
      "mov rax, [ rsp + 0x10 ]; load m64 out1 to register64\n"
      "mov [ rax + 0x8 ], r10; out1[1] = x185\n"
      "cmovc rbx, r12; if CF, x187<- x171 (nzVar)\n"
      "mov [ rax + 0x18 ], rbx; out1[3] = x187\n"
      "mov [ rax + 0x10 ], rcx; out1[2] = x186\n"
      "cmovc r11, rbp; if CF, x184<- x165 (nzVar)\n"
      "mov [ rax + 0x0 ], r11; out1[0] = x184\n"
      "mov rbx, [ rsp + 0x128 ]; restoring from stack\n"
      "mov rbp, [ rsp + 0x130 ]; restoring from stack\n"
      "mov r12, [ rsp + 0x138 ]; restoring from stack\n"
      "mov r13, [ rsp + 0x140 ]; restoring from stack\n"
      "mov r14, [ rsp + 0x148 ]; restoring from stack\n"
      "mov r15, [ rsp + 0x150 ]; restoring from stack\n"
      "add rsp, 0x160 \n"
      "ret\n"
      "; cpu Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz\n"
      "; clocked at 2300 MHz\n"
      "; first cyclecount 8364, last 8090\n"
      "; seed 1617262634 \n"
      "; time needed: 13076120 ms / 100000 runs=> 130.7612ms/run\n"
      "; Time spent for assembling and measureing (r=200,e=100): 4657069 ms\n"
      "; Ratio (time for assembling + measure)/(total runtime for 100000runs): "
      "0.3561506777239732\n"
      "; number reverted permutation/ tried permutation: 23408 / 33392 "
      "=0.701006229036895\n"
      "; number reverted spill/ tried spill: 23108 / 33078 "
      "=0.6985912086583228\n"
      "; number reverted decision/ tried decision: 23168 / 33529 "
      "=0.6909839243639834\n"
      "; FailedEvals (cannot swap because of edge to the next node): 10196\n"};
  // convenience pointer
  void (*err)(measuresuite_t, const char *) =
      error_handling_helper_template_str;

  const int num_batches = 10;
  const int batch_size = 20;

  // INIT
  const int arg_num_out = 1;
  const int chunksize = 0;

  const uint64_t bounds[] = {0xffffffffffffffff, 0xffffffffffffffff,
                             0xffffffffffffffff, 0xffffffffffffffff};
  measuresuite_t ms = NULL;
  if (ms_measure_init(&ms, arg_width, arg_num_in, arg_num_out, chunksize,
                      bounds, "./liball_fiat.so", symbol)) {
    err(ms, "Failed to measure_init. Reason: %s.");
    return 1;
  }

  // measure
  if (ms_measure(ms, fa, fb, batch_size, num_batches)) {
    err(ms, "Failed to measure. Reason: %s.");
    return 1;
  }
  const char *output = NULL;
  size_t jsonlen = 0;
  ms_getJson(ms, &output, &jsonlen);
  printf("%s\n", output);

  // Require to have true in the string but not false
  if (strstr(output, "true") == NULL && strstr(output, "false") != NULL) {
    fprintf(stderr, "should have been a correct result\n");
    ms_measure_end(ms);
    return 1;
  }
  // END
  if (ms_measure_end(ms)) {
    err(ms, "Failed to measure_end. Reason: %s.");
    return 1;
  }
  return 0;
}
