/**
 * Copyright 2022 University of Adelaide
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#include "helper.h"
#include <measuresuite.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>

const char symbol[] = {"fiat_p256_square"};
const int arg_width = 4;
const int arg_num_in = 1;

int main() {
  SIGILL_SETUP();

  char fa[] = {
      "SECTION .text\n"
      "	GLOBAL square_p256\n"
      "square_p256:\n"
      "sub rsp, 0x180 \n"
      "mov [ rsp + 0x148 ], rbx; saving to stack\n"
      "mov [ rsp + 0x150 ], rbp; saving to stack\n"
      "mov [ rsp + 0x158 ], r12; saving to stack\n"
      "mov [ rsp + 0x160 ], r13; saving to stack\n"
      "mov [ rsp + 0x168 ], r14; saving to stack\n"
      "mov [ rsp + 0x170 ], r15; saving to stack\n"
      "mov r9, [ rsi + 0x18 ]; load m64 x3 to register64\n"
      "mov rdx, r9; x3 to rdx\n"
      "mulx r8, rbx, [ rsi + 0x0 ]; x136, x135<- x3 * arg1[0]\n"
      "mulx r10, r14, [ rsi + 0x18 ]; x130, x129<- x3 * arg1[3]\n"
      "mulx rcx, r11, [ rsi + 0x8 ]; x134, x133<- x3 * arg1[1]\n"
      "mulx rdx, r9, [ rsi + 0x10 ]; x132, x131<- x3 * arg1[2]\n"
      "mov rax, [ rsi + 0x0 ]; load m64 x4 to register64\n"
      "xor r13, r13\n"
      "adox r11, r8\n"
      "adox r9, rcx\n"
      "adox r14, rdx\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx rbp, r15, rax; x12, x11<- x4 * arg1[0]\n"
      "mov rdx, [ rsi + 0x8 ]; arg1[1] to rdx\n"
      "mulx r12, r8, rax; x10, x9<- x4 * arg1[1]\n"
      "adox r10, r13\n"
      "mov rdx, 0xffffffff ; moving imm to reg\n"
      "mulx rcx, r13, r15; x23, x22<- x11 * 0xffffffff\n"
      "mov rdx, 0xffffffffffffffff ; moving imm to reg\n"
      "mov [ rsp + 0x0 ], r11; spilling x137 to mem\n"
      "mov [ rsp + 0x8 ], r10; spilling x143 to mem\n"
      "mulx r11, r10, r15; x25, x24<- x11 * 0xffffffffffffffff\n"
      "adcx r8, rbp\n"
      "mov rbp, [ rsi + 0x8 ]; load m64 x1 to register64\n"
      "mov rdx, -0x2 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r13, r11\n"
      "seto dl; spill OF x27 to reg (rdx)\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, r15\n"
      "adox r13, r8\n"
      "movzx r10, dl; x28, copying x27 here, cause x27 is needed in a reg for "
      "other than x28, namely all: , x28, size: 1\n"
      "lea r10, [ r10 + rcx ]\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r11, rcx, rbp; x46, x45<- x1 * arg1[0]\n"
      "mov rdx, rbp; x1 to rdx\n"
      "mulx rbp, r8, [ rsi + 0x8 ]; x44, x43<- x1 * arg1[1]\n"
      "xchg rdx, rax; x4, swapping with x1, which is currently in rdx\n"
      "mov [ rsp + 0x10 ], rbp; spilling x44 to mem\n"
      "mov [ rsp + 0x18 ], r10; spilling x28 to mem\n"
      "mulx rbp, r10, [ rsi + 0x10 ]; x8, x7<- x4 * arg1[2]\n"
      "mov [ rsp + 0x20 ], rbp; spilling x8 to mem\n"
      "setc bpl; spill CF x14 to reg (rbp)\n"
      "clc;\n"
      "adcx rcx, r13\n"
      "mov r13, 0xffffffff ; moving imm to reg\n"
      "xchg rdx, r13; 0xffffffff, swapping with x4, which is currently in rdx\n"
      "mov [ rsp + 0x28 ], rsi; spilling arg1 to mem\n"
      "mov [ rsp + 0x30 ], r14; spilling x141 to mem\n"
      "mulx rsi, r14, rcx; x67, x66<- x54 * 0xffffffff\n"
      "mov rdx, 0xffffffffffffffff ; moving imm to reg\n"
      "mov [ rsp + 0x38 ], rsi; spilling x67 to mem\n"
      "mov [ rsp + 0x40 ], rdi; spilling out1 to mem\n"
      "mulx rsi, rdi, rcx; x69, x68<- x54 * 0xffffffffffffffff\n"
      "setc dl; spill CF x55 to reg (rdx)\n"
      "clc;\n"
      "adcx r8, r11\n"
      "mov r11, [ rsp + 0x28 ]; load m64 arg1 to register64\n"
      "mov [ rsp + 0x48 ], rsi; spilling x69 to mem\n"
      "mov rsi, [ r11 + 0x10 ]; load m64 x2 to register64\n"
      "mov [ rsp + 0x28 ], r11; spilling arg1 to mem\n"
      "seto r11b; spill OF x32 to reg (r11)\n"
      "mov [ rsp + 0x50 ], rcx; spilling x54 to mem\n"
      "mov rcx, -0x2 ; moving imm to reg\n"
      "inc rcx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r14, [ rsp + 0x48 ]\n"
      "setc cl; spill CF x48 to reg (rcx)\n"
      "clc;\n"
      "adcx rdi, [ rsp + 0x50 ]\n"
      "mov byte [ rsp + 0x58 ], dl; spilling byte x55 to mem\n"
      "setc dl; spill CF x74 to reg (rdx)\n"
      "clc;\n"
      "mov [ rsp + 0x60 ], r9; spilling x139 to mem\n"
      "mov r9, -0x1 ; moving imm to reg\n"
      "movzx rbp, bpl\n"
      "adcx rbp, r9; loading flag\n"
      "adcx r12, r10\n"
      "setc bpl; spill CF x16 to reg (rbp)\n"
      "clc;\n"
      "movzx r11, r11b\n"
      "adcx r11, r9; loading flag\n"
      "adcx r12, [ rsp + 0x18 ]\n"
      "setc r11b; spill CF x34 to reg (r11)\n"
      "movzx r10, byte [ rsp + 0x58 ]; load byte memx55 to register64\n"
      "clc;\n"
      "adcx r10, r9; loading flag\n"
      "adcx r12, r8\n"
      "seto r10b; spill OF x71 to reg (r10)\n"
      "inc r9; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r8, -0x1 ; moving imm to reg\n"
      "movzx rdx, dl\n"
      "adox rdx, r8; loading flag\n"
      "adox r12, r14\n"
      "mov r14, [ rsp + 0x28 ]; load m64 arg1 to register64\n"
      "mov rdx, [ r14 + 0x18 ]; arg1[3] to rdx\n"
      "mulx r13, r9, r13; x6, x5<- x4 * arg1[3]\n"
      "mov rdx, rsi; x2 to rdx\n"
      "mov byte [ rsp + 0x68 ], bpl; spilling byte x16 to mem\n"
      "mulx r8, rbp, [ r14 + 0x0 ]; x91, x90<- x2 * arg1[0]\n"
      "mov [ rsp + 0x28 ], r14; spilling arg1 to mem\n"
      "mov r14, 0xffffffff00000001 ; moving imm to reg\n"
      "xchg rdx, r14; 0xffffffff00000001, swapping with x2, which is currently "
      "in rdx\n"
      "mov [ rsp + 0x70 ], r13; spilling x6 to mem\n"
      "mulx r15, r13, r15; x21, x20<- x11 * 0xffffffff00000001\n"
      "setc dl; spill CF x57 to reg (rdx)\n"
      "clc;\n"
      "adcx rbp, r12\n"
      "mov r12, [ rsp + 0x28 ]; load m64 arg1 to register64\n"
      "xchg rdx, rax; x1, swapping with x57, which is currently in rdx\n"
      "mov [ rsp + 0x78 ], r15; spilling x21 to mem\n"
      "mov [ rsp + 0x80 ], rbp; spilling x99 to mem\n"
      "mulx r15, rbp, [ r12 + 0x10 ]; x42, x41<- x1 * arg1[2]\n"
      "mov [ rsp + 0x28 ], r12; spilling arg1 to mem\n"
      "mov r12, 0xffffffffffffffff ; moving imm to reg\n"
      "xchg rdx, r12; 0xffffffffffffffff, swapping with x1, which is currently "
      "in rdx\n"
      "mov [ rsp + 0x88 ], r8; spilling x91 to mem\n"
      "mov [ rsp + 0x90 ], r12; spilling x1 to mem\n"
      "mulx r8, r12, [ rsp + 0x80 ]; x114, x113<- x99 * 0xffffffffffffffff\n"
      "movzx rdx, r10b; x72, copying x71 here, cause x71 is needed in a reg "
      "for "
      "other than x72, namely all: , x72, size: 1\n"
      "mov [ rsp + 0x98 ], r9; spilling x5 to mem\n"
      "mov r9, [ rsp + 0x38 ]; load m64 x67 to register64\n"
      "lea rdx, [ rdx + r9 ]; r8/64 + m8\n"
      "setc r9b; spill CF x100 to reg (r9)\n"
      "clc;\n"
      "adcx r12, [ rsp + 0x80 ]\n"
      "seto r12b; spill OF x76 to reg (r12)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r10, -0x2 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx rcx, cl\n"
      "adox rcx, r10; loading flag\n"
      "adox rbp, [ rsp + 0x10 ]\n"
      "mov rcx, [ rsp + 0x28 ]; load m64 arg1 to register64\n"
      "mov r10, rdx; preserving value of x72 into a new reg\n"
      "mov rdx, [ rcx + 0x8 ]; saving arg1[1] in rdx.\n"
      "mov [ rsp + 0xa0 ], rbx; spilling x135 to mem\n"
      "mov [ rsp + 0xa8 ], rbp; spilling x49 to mem\n"
      "mulx rbx, rbp, r14; x89, x88<- x2 * arg1[1]\n"
      "mov rdx, [ rsp + 0x20 ]; load m64 x8 to register64\n"
      "mov [ rsp + 0x28 ], rcx; spilling arg1 to mem\n"
      "seto cl; spill OF x50 to reg (rcx)\n"
      "mov [ rsp + 0xb0 ], rbx; spilling x89 to mem\n"
      "movzx rbx, byte [ rsp + 0x68 ]; load byte memx16 to register64\n"
      "mov [ rsp + 0xb8 ], r10; spilling x72 to mem\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r10, -0x2 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "adox rbx, r10; loading flag\n"
      "adox rdx, [ rsp + 0x98 ]\n"
      "seto bl; spill OF x18 to reg (rbx)\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx r11, r11b\n"
      "adox r11, r10; loading flag\n"
      "adox rdx, r13\n"
      "seto r11b; spill OF x36 to reg (r11)\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "movzx rax, al\n"
      "adox rax, r13; loading flag\n"
      "adox rdx, [ rsp + 0xa8 ]\n"
      "seto al; spill OF x59 to reg (rax)\n"
      "mov r13, -0x2 ; moving imm to reg\n"
      "inc r13; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbp, [ rsp + 0x88 ]\n"
      "seto r13b; spill OF x93 to reg (r13)\n"
      "dec r10; OF<-0x0, preserve CF (debug: state 3)\n"
      "movzx r12, r12b\n"
      "adox r12, r10; loading flag\n"
      "adox rdx, [ rsp + 0xb8 ]\n"
      "seto r12b; spill OF x78 to reg (r12)\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx r9, r9b\n"
      "adox r9, r10; loading flag\n"
      "adox rdx, rbp\n"
      "mov r9, [ rsp + 0x28 ]; load m64 arg1 to register64\n"
      "mov rbp, rdx; preserving value of x101 into a new reg\n"
      "mov rdx, [ r9 + 0x18 ]; saving arg1[3] in rdx.\n"
      "mov byte [ rsp + 0xc0 ], al; spilling byte x59 to mem\n"
      "mulx r10, rax, [ rsp + 0x90 ]; x40, x39<- x1 * arg1[3]\n"
      "mov rdx, 0xffffffff ; moving imm to reg\n"
      "mov [ rsp + 0x28 ], r9; spilling arg1 to mem\n"
      "mov byte [ rsp + 0xc8 ], r13b; spilling byte x93 to mem\n"
      "mulx r9, r13, [ rsp + 0x80 ]; x112, x111<- x99 * 0xffffffff\n"
      "seto dl; spill OF x102 to reg (rdx)\n"
      "mov [ rsp + 0xd0 ], r9; spilling x112 to mem\n"
      "mov r9, -0x1 ; moving imm to reg\n"
      "inc r9; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r9, -0x2 ; moving imm to reg\n"
      "inc r9; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r9, -0x1 ; moving imm to reg\n"
      "movzx rcx, cl\n"
      "adox rcx, r9; loading flag\n"
      "adox r15, rax\n"
      "setc cl; spill CF x119 to reg (rcx)\n"
      "clc;\n"
      "adcx r13, r8\n"
      "seto r8b; spill OF x52 to reg (r8)\n"
      "inc r9; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "movzx rcx, cl\n"
      "adox rcx, rax; loading flag\n"
      "adox rbp, r13\n"
      "setc cl; spill CF x116 to reg (rcx)\n"
      "clc;\n"
      "adcx rbp, [ rsp + 0xa0 ]\n"
      "movzx r13, bl; x19, copying x18 here, cause x18 is needed in a reg for "
      "other than x19, namely all: , x19, size: 1\n"
      "mov r9, [ rsp + 0x70 ]; load m64 x6 to register64\n"
      "lea r13, [ r13 + r9 ]; r8/64 + m8\n"
      "setc r9b; spill CF x145 to reg (r9)\n"
      "clc;\n"
      "movzx r11, r11b\n"
      "adcx r11, rax; loading flag\n"
      "adcx r13, [ rsp + 0x78 ]\n"
      "mov rbx, 0xffffffff00000001 ; moving imm to reg\n"
      "mov r11b, dl; preserving value of x102 into a new reg\n"
      "mov rdx, [ rsp + 0x50 ]; saving x54 in rdx.\n"
      "mulx rdx, rax, rbx; x65, x64<- x54 * 0xffffffff00000001\n"
      "mov rbx, 0xffffffffffffffff ; moving imm to reg\n"
      "xchg rdx, rbx; 0xffffffffffffffff, swapping with x65, which is "
      "currently "
      "in rdx\n"
      "mov byte [ rsp + 0xd8 ], r11b; spilling byte x102 to mem\n"
      "mov [ rsp + 0xe0 ], rbx; spilling x65 to mem\n"
      "mulx r11, rbx, rbp; x159, x158<- x144 * 0xffffffffffffffff\n"
      "seto dl; spill OF x121 to reg (rdx)\n"
      "mov byte [ rsp + 0xe8 ], r12b; spilling byte x78 to mem\n"
      "mov r12, -0x2 ; moving imm to reg\n"
      "inc r12; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbx, rbp\n"
      "movzx rbx, cl; x117, copying x116 here, cause x116 is needed in a reg "
      "for "
      "other than x117, namely all: , x117, size: 1\n"
      "mov r12, [ rsp + 0xd0 ]; load m64 x112 to register64\n"
      "lea rbx, [ rbx + r12 ]; r8/64 + m8\n"
      "mov r12, [ rsp + 0x28 ]; load m64 arg1 to register64\n"
      "xchg rdx, r14; x2, swapping with x121, which is currently in rdx\n"
      "mov [ rsp + 0xf0 ], r13; spilling x37 to mem\n"
      "mulx rcx, r13, [ r12 + 0x10 ]; x87, x86<- x2 * arg1[2]\n"
      "mov [ rsp + 0x28 ], r12; spilling arg1 to mem\n"
      "seto r12b; spill OF x164 to reg (r12)\n"
      "mov [ rsp + 0xf8 ], rcx; spilling x87 to mem\n"
      "movzx rcx, byte [ rsp + 0xc0 ]; load byte memx59 to register64\n"
      "mov [ rsp + 0x100 ], rbx; spilling x117 to mem\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rbx, -0x2 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "adox rcx, rbx; loading flag\n"
      "adox r15, [ rsp + 0xf0 ]\n"
      "movzx rcx, r8b; x53, copying x52 here, cause x52 is needed in a reg for "
      "other than x53, namely all: , x53, size: 1\n"
      "lea rcx, [ rcx + r10 ]\n"
      "seto r10b; spill OF x61 to reg (r10)\n"
      "movzx r8, byte [ rsp + 0xc8 ]; load byte memx93 to register64\n"
      "inc rbx; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "adox r8, rbx; loading flag\n"
      "adox r13, [ rsp + 0xb0 ]\n"
      "seto r8b; spill OF x95 to reg (r8)\n"
      "movzx rbx, byte [ rsp + 0xe8 ]; load byte memx78 to register64\n"
      "mov [ rsp + 0x108 ], rdx; spilling x2 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rdx, -0x2 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "adox rbx, rdx; loading flag\n"
      "adox r15, rax\n"
      "mov rbx, 0xffffffff ; moving imm to reg\n"
      "mov rdx, rbx; 0xffffffff to rdx\n"
      "mulx rbx, rax, rbp; x157, x156<- x144 * 0xffffffff\n"
      "setc dl; spill CF x38 to reg (rdx)\n"
      "mov byte [ rsp + 0x110 ], r8b; spilling byte x95 to mem\n"
      "movzx r8, byte [ rsp + 0xd8 ]; load byte memx102 to register64\n"
      "clc;\n"
      "mov [ rsp + 0x118 ], rbx; spilling x157 to mem\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "adcx r8, rbx; loading flag\n"
      "adcx r15, r13\n"
      "setc r8b; spill CF x104 to reg (r8)\n"
      "clc;\n"
      "adcx rax, r11\n"
      "seto r11b; spill OF x80 to reg (r11)\n"
      "inc rbx; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "movzx r14, r14b\n"
      "adox r14, r13; loading flag\n"
      "adox r15, [ rsp + 0x100 ]\n"
      "seto r14b; spill OF x123 to reg (r14)\n"
      "inc r13; OF<-0x0, preserve CF (debug: state 1)\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "movzx r9, r9b\n"
      "adox r9, rbx; loading flag\n"
      "adox r15, [ rsp + 0x0 ]\n"
      "seto r9b; spill OF x147 to reg (r9)\n"
      "inc rbx; OF<-0x0, preserve CF (debug: state 1)\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "movzx r12, r12b\n"
      "adox r12, r13; loading flag\n"
      "adox r15, rax\n"
      "mov r12, 0xffffffff00000001 ; moving imm to reg\n"
      "xchg rdx, r12; 0xffffffff00000001, swapping with x38, which is "
      "currently "
      "in rdx\n"
      "mulx rax, rbx, [ rsp + 0x80 ]; x110, x109<- x99 * 0xffffffff00000001\n"
      "setc dl; spill CF x161 to reg (rdx)\n"
      "seto r13b; spill OF x166 to reg (r13)\n"
      "mov [ rsp + 0x120 ], rax; spilling x110 to mem\n"
      "mov rax, r15; x174, copying x165 here, cause x165 is needed in a reg "
      "for "
      "other than x174, namely all: , x174--x175, x184, size: 2\n"
      "mov byte [ rsp + 0x128 ], r11b; spilling byte x80 to mem\n"
      "mov r11, 0xffffffffffffffff ; moving imm to reg\n"
      "sub rax, r11\n"
      "mov r11, -0x1 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r11, -0x1 ; moving imm to reg\n"
      "movzx r12, r12b\n"
      "movzx r10, r10b\n"
      "adox r10, r11; loading flag\n"
      "adox rcx, r12\n"
      "mov r12, [ rsp + 0x28 ]; load m64 arg1 to register64\n"
      "mov r10b, dl; preserving value of x161 into a new reg\n"
      "mov rdx, [ rsp + 0x108 ]; saving x2 in rdx.\n"
      "mulx rdx, r11, [ r12 + 0x18 ]; x85, x84<- x2 * arg1[3]\n"
      "mov [ rsp + 0x130 ], r15; spilling x165 to mem\n"
      "setc r15b; spill CF x175 to reg (r15)\n"
      "mov [ rsp + 0x28 ], r12; spilling arg1 to mem\n"
      "movzx r12, byte [ rsp + 0x110 ]; load byte memx95 to register64\n"
      "clc;\n"
      "mov [ rsp + 0x138 ], rbx; spilling x109 to mem\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "adcx r12, rbx; loading flag\n"
      "adcx r11, [ rsp + 0xf8 ]\n"
      "seto r12b; spill OF x63 to reg (r12)\n"
      "movzx rbx, byte [ rsp + 0x128 ]; load byte memx80 to register64\n"
      "mov [ rsp + 0x140 ], rdx; spilling x85 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov rdx, -0x2 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "adox rbx, rdx; loading flag\n"
      "adox rcx, [ rsp + 0xe0 ]\n"
      "movzx rbx, r10b; x162, copying x161 here, cause x161 is needed in a reg "
      "for other than x162, namely all: , x162, size: 1\n"
      "mov rdx, [ rsp + 0x118 ]; load m64 x157 to register64\n"
      "lea rbx, [ rbx + rdx ]; r8/64 + m8\n"
      "movzx rdx, r12b; x83, copying x63 here, cause x63 is needed in a reg "
      "for "
      "other than x83, namely all: , x83, size: 1\n"
      "mov r10, 0x0 ; moving imm to reg\n"
      "adox rdx, r10\n"
      "dec r10; OF<-0x0, preserve CF (debug: state 3)\n"
      "movzx r8, r8b\n"
      "adox r8, r10; loading flag\n"
      "adox rcx, r11\n"
      "seto r8b; spill OF x106 to reg (r8)\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r12, -0x1 ; moving imm to reg\n"
      "movzx r14, r14b\n"
      "adox r14, r12; loading flag\n"
      "adox rcx, [ rsp + 0x138 ]\n"
      "mov r14, [ rsp + 0x140 ]; x98, copying x85 here, cause x85 is needed in "
      "a "
      "reg for other than x98, namely all: , x98, size: 1\n"
      "adcx r14, r10\n"
      "clc;\n"
      "movzx r9, r9b\n"
      "adcx r9, r12; loading flag\n"
      "adcx rcx, [ rsp + 0x60 ]\n"
      "seto r9b; spill OF x125 to reg (r9)\n"
      "inc r12; OF<-0x0, preserve CF (debug: state 1)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx r8, r8b\n"
      "adox r8, r10; loading flag\n"
      "adox rdx, r14\n"
      "setc r11b; spill CF x149 to reg (r11)\n"
      "clc;\n"
      "movzx r13, r13b\n"
      "adcx r13, r10; loading flag\n"
      "adcx rcx, rbx\n"
      "mov r13, 0xffffffff00000001 ; moving imm to reg\n"
      "xchg rdx, r13; 0xffffffff00000001, swapping with x107, which is "
      "currently "
      "in rdx\n"
      "mulx rbp, rbx, rbp; x155, x154<- x144 * 0xffffffff00000001\n"
      "setc r8b; spill CF x168 to reg (r8)\n"
      "seto r14b; spill OF x108 to reg (r14)\n"
      "movzx r12, r15b; x175, copying x175 here, cause x175 is needed in a reg "
      "for other than x175, namely all: , x176--x177, size: 1\n"
      "add r12, -0x1\n"
      "mov r12, rcx; x176, copying x167 here, cause x167 is needed in a reg "
      "for "
      "other than x176, namely all: , x176--x177, x185, size: 2\n"
      "mov r15, 0xffffffff ; moving imm to reg\n"
      "sbb r12, r15\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx r9, r9b\n"
      "adox r9, r10; loading flag\n"
      "adox r13, [ rsp + 0x120 ]\n"
      "movzx r9, r14b; x128, copying x108 here, cause x108 is needed in a reg "
      "for other than x128, namely all: , x128, size: 1\n"
      "mov rdx, 0x0 ; moving imm to reg\n"
      "adox r9, rdx\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 1)\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r11, r11b\n"
      "adox r11, rdx; loading flag\n"
      "adox r13, [ rsp + 0x30 ]\n"
      "mov r11, [ rsp + 0x8 ]; x152, copying x143 here, cause x143 is needed "
      "in "
      "a reg for other than x152, namely all: , x152--x153, size: 1\n"
      "adox r11, r9\n"
      "seto r14b; spill OF x153 to reg (r14)\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 1)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "movzx r8, r8b\n"
      "adox r8, r10; loading flag\n"
      "adox r13, rbx\n"
      "adox rbp, r11\n"
      "movzx r8, r14b; x173, copying x153 here, cause x153 is needed in a reg "
      "for other than x173, namely all: , x173, size: 1\n"
      "adox r8, rdx\n"
      "mov rbx, r13; x178, copying x169 here, cause x169 is needed in a reg "
      "for "
      "other than x178, namely all: , x186, x178--x179, size: 2\n"
      "sbb rbx, 0x00000000\n"
      "mov r9, rbp; x180, copying x171 here, cause x171 is needed in a reg for "
      "other than x180, namely all: , x187, x180--x181, size: 2\n"
      "mov r14, 0xffffffff00000001 ; moving imm to reg\n"
      "sbb r9, r14\n"
      "sbb r8, 0x00000000\n"
      "cmovc r9, rbp; if CF, x187<- x171 (nzVar)\n"
      "cmovc rax, [ rsp + 0x130 ]; if CF, x184<- x165 (nzVar)\n"
      "mov r8, [ rsp + 0x40 ]; load m64 out1 to register64\n"
      "mov [ r8 + 0x18 ], r9; out1[3] = x187\n"
      "cmovc r12, rcx; if CF, x185<- x167 (nzVar)\n"
      "mov [ r8 + 0x8 ], r12; out1[1] = x185\n"
      "cmovc rbx, r13; if CF, x186<- x169 (nzVar)\n"
      "mov [ r8 + 0x10 ], rbx; out1[2] = x186\n"
      "mov [ r8 + 0x0 ], rax; out1[0] = x184\n"
      "mov rbx, [ rsp + 0x148 ]; restoring from stack\n"
      "mov rbp, [ rsp + 0x150 ]; restoring from stack\n"
      "mov r12, [ rsp + 0x158 ]; restoring from stack\n"
      "mov r13, [ rsp + 0x160 ]; restoring from stack\n"
      "mov r14, [ rsp + 0x168 ]; restoring from stack\n"
      "mov r15, [ rsp + 0x170 ]; restoring from stack\n"
      "add rsp, 0x180 \n"
      "ret\n"
      "; cpu Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz\n"
      "; clocked at 2300 MHz\n"
      "; first cyclecount 8548.5, last 7907\n"
      "; seed 1617262634 \n"
      "; time needed: 12015430 ms / 100000 runs=> 120.1543ms/run\n"
      "; Time spent for assembling and measureing (r=200,e=100): 4262434 ms\n"
      "; Ratio (time for assembling + measure)/(total runtime for 100000runs): "
      "0.35474668821673466\n"
      "; number reverted permutation/ tried permutation: 28872 / 29898 "
      "=0.9656833232992174\n"
      "; number reverted spill/ tried spill: 28863 / 29938 "
      "=0.9640924577460084\n"
      "; number reverted decision/ tried decision: 28971 / 30164 "
      "=0.9604495425009946\n"
      "; FailedEvals (cannot swap because of edge to the next node): 14046\n"};

  char fb[] = {
      "SECTION .text\n"
      "	GLOBAL square_p256\n"
      "square_p256:\n"
      "sub rsp, 0x180 \n"
      "mov [ rsp + 0x148 ], rbx; saving to stack\n"
      "mov [ rsp + 0x150 ], rbp; saving to stack\n"
      "mov [ rsp + 0x158 ], r12; saving to stack\n"
      "mov [ rsp + 0x160 ], r13; saving to stack\n"
      "mov [ rsp + 0x168 ], r14; saving to stack\n"
      "mov [ rsp + 0x170 ], r15; saving to stack\n"
      "mov rbx, [ rsi + 0x18 ]; load m64 x3 to register64\n"
      "mov rdx, rbx; x3 to rdx\n"
      "mulx r15, r9, [ rsi + 0x0 ]; x136, x135<- x3 * arg1[0]\n"
      "mulx r14, r10, [ rsi + 0x18 ]; x130, x129<- x3 * arg1[3]\n"
      "mulx rcx, rbp, [ rsi + 0x10 ]; x132, x131<- x3 * arg1[2]\n"
      "mov r8, [ rsi + 0x0 ]; load m64 x4 to register64\n"
      "mulx rdx, r13, [ rsi + 0x8 ]; x134, x133<- x3 * arg1[1]\n"
      "xor r12, r12\n"
      "adox r13, r15\n"
      "adox rbp, rdx\n"
      "mov rdx, [ rsi + 0x8 ]; arg1[1] to rdx\n"
      "mulx rbx, r11, r8; x10, x9<- x4 * arg1[1]\n"
      "adox r10, rcx\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx rax, r15, r8; x12, x11<- x4 * arg1[0]\n"
      "mov rdx, 0xffffffffffffffff ; moving imm to reg\n"
      "mulx rcx, r12, r15; x25, x24<- x11 * 0xffffffffffffffff\n"
      "mov rdx, 0x0 ; moving imm to reg\n"
      "adox r14, rdx\n"
      "mov rdx, 0xffffffff ; moving imm to reg\n"
      "mov [ rsp + 0x0 ], r13; spilling x137 to mem\n"
      "mov [ rsp + 0x8 ], r14; spilling x143 to mem\n"
      "mulx r13, r14, r15; x23, x22<- x11 * 0xffffffff\n"
      "mov rdx, [ rsi + 0x8 ]; load m64 x1 to register64\n"
      "adcx r11, rax\n"
      "mov rax, -0x2 ; moving imm to reg\n"
      "inc rax; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r14, rcx\n"
      "seto al; spill OF x27 to reg (rax)\n"
      "mov rcx, -0x2 ; moving imm to reg\n"
      "inc rcx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r12, r15\n"
      "adox r14, r11\n"
      "movzx r12, al; x28, copying x27 here, cause x27 is needed in a reg for "
      "other than x28, namely all: , x28, size: 1\n"
      "lea r12, [ r12 + r13 ]\n"
      "mulx rcx, r13, [ rsi + 0x0 ]; x46, x45<- x1 * arg1[0]\n"
      "mulx r11, rax, [ rsi + 0x8 ]; x44, x43<- x1 * arg1[1]\n"
      "mov [ rsp + 0x10 ], r11; spilling x44 to mem\n"
      "setc r11b; spill CF x14 to reg (r11)\n"
      "clc;\n"
      "adcx r13, r14\n"
      "mov r14, 0xffffffff ; moving imm to reg\n"
      "xchg rdx, r14; 0xffffffff, swapping with x1, which is currently in rdx\n"
      "mov [ rsp + 0x18 ], rsi; spilling arg1 to mem\n"
      "mov [ rsp + 0x20 ], r12; spilling x28 to mem\n"
      "mulx rsi, r12, r13; x67, x66<- x54 * 0xffffffff\n"
      "mov rdx, 0xffffffffffffffff ; moving imm to reg\n"
      "mov [ rsp + 0x28 ], r10; spilling x141 to mem\n"
      "mov [ rsp + 0x30 ], rsi; spilling x67 to mem\n"
      "mulx r10, rsi, r13; x69, x68<- x54 * 0xffffffffffffffff\n"
      "mov rdx, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov [ rsp + 0x38 ], r10; spilling x69 to mem\n"
      "mov r10, rdx; preserving value of arg1 into a new reg\n"
      "mov rdx, [ rdx + 0x10 ]; saving arg1[2] in rdx.\n"
      "mov [ rsp + 0x40 ], r13; spilling x54 to mem\n"
      "mov [ rsp + 0x48 ], rsi; spilling x68 to mem\n"
      "mulx r13, rsi, r8; x8, x7<- x4 * arg1[2]\n"
      "mov rdx, [ rsp + 0x40 ]; load m64 x54 to register64\n"
      "mov [ rsp + 0x50 ], r13; spilling x8 to mem\n"
      "mov r13, rdx; _, copying x54 here, cause x54 is needed in a reg for "
      "other "
      "than _, namely all: , x64--x65, _--x74, size: 2\n"
      "mov [ rsp + 0x18 ], r10; spilling arg1 to mem\n"
      "seto r10b; spill OF x32 to reg (r10)\n"
      "mov [ rsp + 0x58 ], rdi; spilling out1 to mem\n"
      "mov rdi, -0x2 ; moving imm to reg\n"
      "inc rdi; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r13, [ rsp + 0x48 ]\n"
      "mov r13, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov [ rsp + 0x40 ], rdx; spilling x54 to mem\n"
      "mov rdx, [ r13 + 0x10 ]; load m64 x2 to register64\n"
      "mov [ rsp + 0x18 ], r13; spilling arg1 to mem\n"
      "setc r13b; spill CF x55 to reg (r13)\n"
      "clc;\n"
      "adcx rax, rcx\n"
      "seto cl; spill OF x74 to reg (rcx)\n"
      "mov byte [ rsp + 0x60 ], r13b; spilling byte x55 to mem\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "inc r13; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r13, -0x2 ; moving imm to reg\n"
      "inc r13; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r13, -0x1 ; moving imm to reg\n"
      "movzx r11, r11b\n"
      "adox r11, r13; loading flag\n"
      "adox rbx, rsi\n"
      "seto r11b; spill OF x16 to reg (r11)\n"
      "inc r13; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rsi, -0x1 ; moving imm to reg\n"
      "movzx r10, r10b\n"
      "adox r10, rsi; loading flag\n"
      "adox rbx, [ rsp + 0x20 ]\n"
      "seto r10b; spill OF x34 to reg (r10)\n"
      "mov rsi, -0x2 ; moving imm to reg\n"
      "inc rsi; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r12, [ rsp + 0x38 ]\n"
      "setc r13b; spill CF x48 to reg (r13)\n"
      "mov byte [ rsp + 0x68 ], r11b; spilling byte x16 to mem\n"
      "movzx r11, byte [ rsp + 0x60 ]; load byte memx55 to register64\n"
      "clc;\n"
      "mov byte [ rsp + 0x70 ], cl; spilling byte x74 to mem\n"
      "mov rcx, -0x1 ; moving imm to reg\n"
      "adcx r11, rcx; loading flag\n"
      "adcx rbx, rax\n"
      "setc r11b; spill CF x57 to reg (r11)\n"
      "movzx rax, byte [ rsp + 0x70 ]; load byte memx74 to register64\n"
      "clc;\n"
      "adcx rax, rcx; loading flag\n"
      "adcx rbx, r12\n"
      "mov rax, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov r12, rdx; preserving value of x2 into a new reg\n"
      "mov rdx, [ rax + 0x18 ]; saving arg1[3] in rdx.\n"
      "mulx r8, rcx, r8; x6, x5<- x4 * arg1[3]\n"
      "mov rdx, 0xffffffff00000001 ; moving imm to reg\n"
      "mov [ rsp + 0x18 ], rax; spilling arg1 to mem\n"
      "mulx r15, rax, r15; x21, x20<- x11 * 0xffffffff00000001\n"
      "mov rdx, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov [ rsp + 0x78 ], r15; spilling x21 to mem\n"
      "mov r15, rdx; preserving value of arg1 into a new reg\n"
      "mov rdx, [ rdx + 0x0 ]; saving arg1[0] in rdx.\n"
      "mov [ rsp + 0x80 ], r8; spilling x6 to mem\n"
      "mov [ rsp + 0x88 ], rbp; spilling x139 to mem\n"
      "mulx r8, rbp, r12; x91, x90<- x2 * arg1[0]\n"
      "setc dl; spill CF x76 to reg (rdx)\n"
      "clc;\n"
      "adcx rbp, rbx\n"
      "mov rbx, 0xffffffffffffffff ; moving imm to reg\n"
      "xchg rdx, rbp; x99, swapping with x76, which is currently in rdx\n"
      "mov [ rsp + 0x18 ], r15; spilling arg1 to mem\n"
      "mov [ rsp + 0x90 ], r8; spilling x91 to mem\n"
      "mulx r15, r8, rbx; x114, x113<- x99 * 0xffffffffffffffff\n"
      "mov rbx, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov [ rsp + 0x98 ], rcx; spilling x5 to mem\n"
      "mov rcx, rdx; preserving value of x99 into a new reg\n"
      "mov rdx, [ rbx + 0x10 ]; saving arg1[2] in rdx.\n"
      "mov [ rsp + 0xa0 ], r9; spilling x135 to mem\n"
      "mov [ rsp + 0xa8 ], r12; spilling x2 to mem\n"
      "mulx r9, r12, r14; x42, x41<- x1 * arg1[2]\n"
      "mov rdx, [ rsp + 0x30 ]; x72, copying x67 here, cause x67 is needed in "
      "a "
      "reg for other than x72, namely all: , x72, size: 1\n"
      "mov [ rsp + 0x18 ], rbx; spilling arg1 to mem\n"
      "mov rbx, 0x0 ; moving imm to reg\n"
      "adox rdx, rbx\n"
      "dec rbx; OF<-0x0, preserve CF (debug: state 3)\n"
      "movzx r13, r13b\n"
      "adox r13, rbx; loading flag\n"
      "adox r12, [ rsp + 0x10 ]\n"
      "seto r13b; spill OF x50 to reg (r13)\n"
      "inc rbx; OF<-0x0, preserve CF (debug: state 2)\n"
      "adox r8, rcx\n"
      "mov rbx, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov r8, rdx; preserving value of x72 into a new reg\n"
      "mov rdx, [ rbx + 0x8 ]; saving arg1[1] in rdx.\n"
      "mov [ rsp + 0xb0 ], rcx; spilling x99 to mem\n"
      "mov byte [ rsp + 0xb8 ], r13b; spilling byte x50 to mem\n"
      "mulx rcx, r13, [ rsp + 0xa8 ]; x89, x88<- x2 * arg1[1]\n"
      "mov rdx, [ rsp + 0x98 ]; load m64 x5 to register64\n"
      "mov [ rsp + 0x18 ], rbx; spilling arg1 to mem\n"
      "seto bl; spill OF x119 to reg (rbx)\n"
      "mov [ rsp + 0xc0 ], rcx; spilling x89 to mem\n"
      "movzx rcx, byte [ rsp + 0x68 ]; load byte memx16 to register64\n"
      "mov [ rsp + 0xc8 ], r8; spilling x72 to mem\n"
      "mov r8, 0x0 ; moving imm to reg\n"
      "dec r8; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "mov r8, -0x2 ; moving imm to reg\n"
      "inc r8; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r8, -0x1 ; moving imm to reg\n"
      "adox rcx, r8; loading flag\n"
      "adox rdx, [ rsp + 0x50 ]\n"
      "seto cl; spill OF x18 to reg (rcx)\n"
      "inc r8; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r8, -0x1 ; moving imm to reg\n"
      "movzx r10, r10b\n"
      "adox r10, r8; loading flag\n"
      "adox rdx, rax\n"
      "setc r10b; spill CF x100 to reg (r10)\n"
      "clc;\n"
      "movzx r11, r11b\n"
      "adcx r11, r8; loading flag\n"
      "adcx rdx, r12\n"
      "mov r11, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "xchg rdx, r14; x1, swapping with x58, which is currently in rdx\n"
      "mulx rdx, rax, [ r11 + 0x18 ]; x40, x39<- x1 * arg1[3]\n"
      "seto r12b; spill OF x36 to reg (r12)\n"
      "inc r8; OF<-0x0, preserve CF (debug: state 2)\n"
      "adox r13, [ rsp + 0x90 ]\n"
      "seto r8b; spill OF x93 to reg (r8)\n"
      "mov [ rsp + 0x18 ], r11; spilling arg1 to mem\n"
      "mov r11, 0x0 ; moving imm to reg\n"
      "dec r11; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r11, -0x1 ; moving imm to reg\n"
      "movzx rbp, bpl\n"
      "adox rbp, r11; loading flag\n"
      "adox r14, [ rsp + 0xc8 ]\n"
      "setc bpl; spill CF x59 to reg (rbp)\n"
      "clc;\n"
      "movzx r10, r10b\n"
      "adcx r10, r11; loading flag\n"
      "adcx r14, r13\n"
      "mov r10, 0xffffffff ; moving imm to reg\n"
      "mov r13, rdx; preserving value of x40 into a new reg\n"
      "mov rdx, [ rsp + 0xb0 ]; saving x99 in rdx.\n"
      "mov byte [ rsp + 0xd0 ], bpl; spilling byte x59 to mem\n"
      "mulx r11, rbp, r10; x112, x111<- x99 * 0xffffffff\n"
      "setc r10b; spill CF x102 to reg (r10)\n"
      "clc;\n"
      "adcx rbp, r15\n"
      "setc r15b; spill CF x116 to reg (r15)\n"
      "mov byte [ rsp + 0xd8 ], r10b; spilling byte x102 to mem\n"
      "movzx r10, byte [ rsp + 0xb8 ]; load byte memx50 to register64\n"
      "clc;\n"
      "mov [ rsp + 0xb0 ], rdx; spilling x99 to mem\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "adcx r10, rdx; loading flag\n"
      "adcx r9, rax\n"
      "movzx r10, cl; x19, copying x18 here, cause x18 is needed in a reg for "
      "other than x19, namely all: , x19, size: 1\n"
      "mov rax, [ rsp + 0x80 ]; load m64 x6 to register64\n"
      "lea r10, [ r10 + rax ]; r8/64 + m8\n"
      "seto al; spill OF x78 to reg (rax)\n"
      "inc rdx; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rcx, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adox rbx, rcx; loading flag\n"
      "adox r14, rbp\n"
      "setc bl; spill CF x52 to reg (rbx)\n"
      "clc;\n"
      "adcx r14, [ rsp + 0xa0 ]\n"
      "seto bpl; spill OF x121 to reg (rbp)\n"
      "inc rcx; OF<-0x0, preserve CF (debug: state 1)\n"
      "mov rdx, -0x1 ; moving imm to reg\n"
      "movzx r12, r12b\n"
      "adox r12, rdx; loading flag\n"
      "adox r10, [ rsp + 0x78 ]\n"
      "mov r12, 0xffffffffffffffff ; moving imm to reg\n"
      "mov rdx, r14; x144 to rdx\n"
      "mulx r14, rcx, r12; x159, x158<- x144 * 0xffffffffffffffff\n"
      "mov r12, 0xffffffff00000001 ; moving imm to reg\n"
      "mov byte [ rsp + 0xe0 ], r8b; spilling byte x93 to mem\n"
      "mov r8, rdx; preserving value of x144 into a new reg\n"
      "mov rdx, [ rsp + 0x40 ]; saving x54 in rdx.\n"
      "mov [ rsp + 0xe8 ], r11; spilling x112 to mem\n"
      "mulx rdx, r11, r12; x65, x64<- x54 * 0xffffffff00000001\n"
      "movzx r12, r15b; x117, copying x116 here, cause x116 is needed in a reg "
      "for other than x117, namely all: , x117, size: 1\n"
      "mov [ rsp + 0xf0 ], rdx; spilling x65 to mem\n"
      "mov rdx, [ rsp + 0xe8 ]; load m64 x112 to register64\n"
      "lea r12, [ r12 + rdx ]; r8/64 + m8\n"
      "seto dl; spill OF x38 to reg (rdx)\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rcx, r8\n"
      "seto cl; spill OF x164 to reg (rcx)\n"
      "movzx r15, byte [ rsp + 0xd0 ]; load byte memx59 to register64\n"
      "mov byte [ rsp + 0xf8 ], al; spilling byte x78 to mem\n"
      "mov rax, 0x0 ; moving imm to reg\n"
      "dec rax; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "mov rax, -0x2 ; moving imm to reg\n"
      "inc rax; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "adox r15, rax; loading flag\n"
      "adox r10, r9\n"
      "setc r15b; spill CF x145 to reg (r15)\n"
      "movzx r9, byte [ rsp + 0xf8 ]; load byte memx78 to register64\n"
      "clc;\n"
      "adcx r9, rax; loading flag\n"
      "adcx r10, r11\n"
      "mov r9, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov r11b, dl; preserving value of x38 into a new reg\n"
      "mov rdx, [ r9 + 0x10 ]; saving arg1[2] in rdx.\n"
      "mov [ rsp + 0x100 ], r12; spilling x117 to mem\n"
      "mulx rax, r12, [ rsp + 0xa8 ]; x87, x86<- x2 * arg1[2]\n"
      "setc dl; spill CF x80 to reg (rdx)\n"
      "mov [ rsp + 0x18 ], r9; spilling arg1 to mem\n"
      "movzx r9, byte [ rsp + 0xe0 ]; load byte memx93 to register64\n"
      "clc;\n"
      "mov [ rsp + 0x108 ], rax; spilling x87 to mem\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "adcx r9, rax; loading flag\n"
      "adcx r12, [ rsp + 0xc0 ]\n"
      "movzx r9, bl; x53, copying x52 here, cause x52 is needed in a reg for "
      "other than x53, namely all: , x53, size: 1\n"
      "lea r9, [ r9 + r13 ]\n"
      "mov r13, 0xffffffff ; moving imm to reg\n"
      "xchg rdx, r13; 0xffffffff, swapping with x80, which is currently in "
      "rdx\n"
      "mulx rbx, rax, r8; x157, x156<- x144 * 0xffffffff\n"
      "seto dl; spill OF x61 to reg (rdx)\n"
      "mov byte [ rsp + 0x110 ], r13b; spilling byte x80 to mem\n"
      "mov r13, -0x2 ; moving imm to reg\n"
      "inc r13; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rax, r14\n"
      "seto r13b; spill OF x161 to reg (r13)\n"
      "movzx r14, byte [ rsp + 0xd8 ]; load byte memx102 to register64\n"
      "mov [ rsp + 0x118 ], rbx; spilling x157 to mem\n"
      "mov rbx, 0x0 ; moving imm to reg\n"
      "dec rbx; OF<-0x0, preserve CF (debug: state 4 (thanks Paul))\n"
      "mov rbx, -0x2 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov rbx, -0x1 ; moving imm to reg\n"
      "adox r14, rbx; loading flag\n"
      "adox r10, r12\n"
      "setc r14b; spill CF x95 to reg (r14)\n"
      "clc;\n"
      "movzx rbp, bpl\n"
      "adcx rbp, rbx; loading flag\n"
      "adcx r10, [ rsp + 0x100 ]\n"
      "setc bpl; spill CF x123 to reg (rbp)\n"
      "clc;\n"
      "movzx r15, r15b\n"
      "adcx r15, rbx; loading flag\n"
      "adcx r10, [ rsp + 0x0 ]\n"
      "seto r15b; spill OF x104 to reg (r15)\n"
      "inc rbx; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r12, -0x1 ; moving imm to reg\n"
      "movzx rcx, cl\n"
      "adox rcx, r12; loading flag\n"
      "adox r10, rax\n"
      "mov rcx, 0xffffffff00000001 ; moving imm to reg\n"
      "mov al, dl; preserving value of x61 into a new reg\n"
      "mov rdx, [ rsp + 0xb0 ]; saving x99 in rdx.\n"
      "mulx rdx, rbx, rcx; x110, x109<- x99 * 0xffffffff00000001\n"
      "seto cl; spill OF x166 to reg (rcx)\n"
      "inc r12; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov r12, -0x1 ; moving imm to reg\n"
      "movzx r11, r11b\n"
      "movzx rax, al\n"
      "adox rax, r12; loading flag\n"
      "adox r9, r11\n"
      "setc r11b; spill CF x147 to reg (r11)\n"
      "seto al; spill OF x63 to reg (rax)\n"
      "mov r12, r10; x174, copying x165 here, cause x165 is needed in a reg "
      "for "
      "other than x174, namely all: , x174--x175, x184, size: 2\n"
      "mov [ rsp + 0x120 ], rdx; spilling x110 to mem\n"
      "mov rdx, 0xffffffffffffffff ; moving imm to reg\n"
      "sub r12, rdx\n"
      "mov rdx, [ rsp + 0x18 ]; load m64 arg1 to register64\n"
      "mov [ rsp + 0x128 ], r10; spilling x165 to mem\n"
      "mov r10, rdx; preserving value of arg1 into a new reg\n"
      "mov rdx, [ rdx + 0x18 ]; saving arg1[3] in rdx.\n"
      "mov byte [ rsp + 0x130 ], r14b; spilling byte x95 to mem\n"
      "mov [ rsp + 0x138 ], rbx; spilling x109 to mem\n"
      "mulx r14, rbx, [ rsp + 0xa8 ]; x85, x84<- x2 * arg1[3]\n"
      "movzx rdx, byte [ rsp + 0x110 ]; load byte memx80 to register64\n"
      "mov [ rsp + 0x18 ], r10; spilling arg1 to mem\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (debug: state 5 (thanks Paul))\n"
      "mov r10, -0x2 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "mov r10, -0x1 ; moving imm to reg\n"
      "adox rdx, r10; loading flag\n"
      "adox r9, [ rsp + 0xf0 ]\n"
      "movzx rdx, r13b; x162, copying x161 here, cause x161 is needed in a reg "
      "for other than x162, namely all: , x162, size: 1\n"
      "mov r10, [ rsp + 0x118 ]; load m64 x157 to register64\n"
      "lea rdx, [ rdx + r10 ]; r8/64 + m8\n"
      "setc r10b; spill CF x175 to reg (r10)\n"
      "movzx r13, byte [ rsp + 0x130 ]; load byte memx95 to register64\n"
      "clc;\n"
      "mov [ rsp + 0x140 ], r14; spilling x85 to mem\n"
      "mov r14, -0x1 ; moving imm to reg\n"
      "adcx r13, r14; loading flag\n"
      "adcx rbx, [ rsp + 0x108 ]\n"
      "movzx r13, al; x83, copying x63 here, cause x63 is needed in a reg for "
      "other than x83, namely all: , x83, size: 1\n"
      "mov r14, 0x0 ; moving imm to reg\n"
      "adox r13, r14\n"
      "dec r14; OF<-0x0, preserve CF (debug: state 3)\n"
      "movzx r15, r15b\n"
      "adox r15, r14; loading flag\n"
      "adox r9, rbx\n"
      "mov r15, [ rsp + 0x140 ]; x98, copying x85 here, cause x85 is needed in "
      "a "
      "reg for other than x98, namely all: , x98, size: 1\n"
      "mov rax, 0x0 ; moving imm to reg\n"
      "adcx r15, rax\n"
      "clc;\n"
      "movzx rbp, bpl\n"
      "adcx rbp, r14; loading flag\n"
      "adcx r9, [ rsp + 0x138 ]\n"
      "setc bpl; spill CF x125 to reg (rbp)\n"
      "clc;\n"
      "movzx r11, r11b\n"
      "adcx r11, r14; loading flag\n"
      "adcx r9, [ rsp + 0x88 ]\n"
      "adox r15, r13\n"
      "seto r11b; spill OF x108 to reg (r11)\n"
      "inc r14; OF<-0x0, preserve CF (debug: state 1)\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "movzx rcx, cl\n"
      "adox rcx, rax; loading flag\n"
      "adox r9, rdx\n"
      "mov rcx, 0xffffffff00000001 ; moving imm to reg\n"
      "mov rdx, rcx; 0xffffffff00000001 to rdx\n"
      "mulx r8, rcx, r8; x155, x154<- x144 * 0xffffffff00000001\n"
      "setc bl; spill CF x149 to reg (rbx)\n"
      "seto r13b; spill OF x168 to reg (r13)\n"
      "movzx r14, r10b; x175, copying x175 here, cause x175 is needed in a reg "
      "for other than x175, namely all: , x176--x177, size: 1\n"
      "add r14, -0x1\n"
      "mov r14, r9; x176, copying x167 here, cause x167 is needed in a reg for "
      "other than x176, namely all: , x176--x177, x185, size: 2\n"
      "mov r10, 0xffffffff ; moving imm to reg\n"
      "sbb r14, r10\n"
      "inc rax; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "movzx rbp, bpl\n"
      "adox rbp, rax; loading flag\n"
      "adox r15, [ rsp + 0x120 ]\n"
      "seto bpl; spill OF x127 to reg (rbp)\n"
      "inc rax; OF<-0x0, preserve CF (debug: state 2)\n"
      "mov rax, -0x1 ; moving imm to reg\n"
      "movzx rbx, bl\n"
      "adox rbx, rax; loading flag\n"
      "adox r15, [ rsp + 0x28 ]\n"
      "movzx rbx, bpl; x128, copying x127 here, cause x127 is needed in a reg "
      "for other than x128, namely all: , x128, size: 1\n"
      "movzx r11, r11b\n"
      "lea rbx, [ rbx + r11 ]\n"
      "mov r11, [ rsp + 0x8 ]; x152, copying x143 here, cause x143 is needed "
      "in "
      "a reg for other than x152, namely all: , x152--x153, size: 1\n"
      "adox r11, rbx\n"
      "setc bpl; spill CF x177 to reg (rbp)\n"
      "clc;\n"
      "movzx r13, r13b\n"
      "adcx r13, rax; loading flag\n"
      "adcx r15, rcx\n"
      "adcx r8, r11\n"
      "seto r13b; spill OF x173 to reg (r13)\n"
      "adc r13b, 0x0\n"
      "movzx r13, r13b\n"
      "movzx rcx, bpl; x177, copying x177 here, cause x177 is needed in a reg "
      "for other than x177, namely all: , x178--x179, size: 1\n"
      "add rcx, -0x1\n"
      "mov rcx, r15; x178, copying x169 here, cause x169 is needed in a reg "
      "for "
      "other than x178, namely all: , x186, x178--x179, size: 2\n"
      "sbb rcx, 0x00000000\n"
      "mov rbp, r8; x180, copying x171 here, cause x171 is needed in a reg for "
      "other than x180, namely all: , x187, x180--x181, size: 2\n"
      "sbb rbp, rdx\n"
      "movzx rbx, r13b; _, copying x173 here, cause x173 is needed in a reg "
      "for "
      "other than _, namely all: , _--x183, size: 1\n"
      "sbb rbx, 0x00000000\n"
      "cmovc r12, [ rsp + 0x128 ]; if CF, x184<- x165 (nzVar)\n"
      "cmovc rbp, r8; if CF, x187<- x171 (nzVar)\n"
      "mov rbx, [ rsp + 0x58 ]; load m64 out1 to register64\n"
      "mov [ rbx + 0x18 ], rbp; out1[3] = x187\n"
      "cmovc r14, r9; if CF, x185<- x167 (nzVar)\n"
      "mov [ rbx + 0x8 ], r14; out1[1] = x185\n"
      "mov [ rbx + 0x0 ], r12; out1[0] = x184\n"
      "cmovc rcx, r15; if CF, x186<- x169 (nzVar)\n"
      "mov [ rbx + 0x10 ], rcx; out1[2] = x186\n"
      "mov rbx, [ rsp + 0x148 ]; restoring from stack\n"
      "mov rbp, [ rsp + 0x150 ]; restoring from stack\n"
      "mov r12, [ rsp + 0x158 ]; restoring from stack\n"
      "mov r13, [ rsp + 0x160 ]; restoring from stack\n"
      "mov r14, [ rsp + 0x168 ]; restoring from stack\n"
      "mov r15, [ rsp + 0x170 ]; restoring from stack\n"
      "add rsp, 0x180 \n"
      "ret\n"
      "; cpu Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz\n"
      "; clocked at 2311 MHz\n"
      "; first cyclecount 8548.5, last 7907\n"
      "; seed 1617262634 \n"
      "; time needed: 13236502 ms / 100000 runs=> 132.36502ms/run\n"
      "; Time spent for assembling and measureing (r=200,e=100): 4692360 ms\n"
      "; Ratio (time for assembling + measure)/(total runtime for 100000runs): "
      "0.35450151407071145\n"
      "; number reverted permutation/ tried permutation: 32124 / 33256 "
      "=0.9659610295886456\n"
      "; number reverted spill/ tried spill: 32031 / 33217 "
      "=0.9642953909142908\n"
      "; number reverted decision/ tried decision: 32200 / 33526 "
      "=0.9604486070512438\n"
      "; FailedEvals (cannot swap because of edge to the next node): 15198\n"};
  // convenience pointer
  void (*err)(measuresuite_t, const char *) =
      error_handling_helper_template_str;

  const int num_batches = 10;
  const int batch_size = 20;

  // INIT
  const int arg_num_out = 1;
  const int chunksize = 0;

  const uint64_t bounds[] = {0xffffffffffffffff, 0xffffffffffffffff,
                             0xffffffffffffffff, 0xffffffffffffffff};
  measuresuite_t ms = NULL;
  if (ms_measure_init(&ms, arg_width, arg_num_in, arg_num_out, chunksize,
                      bounds, "./liball_fiat.so", symbol)) {
    err(ms, "Failed to measure_init. Reason: %s.");
    return 1;
  }

  // measure
  if (ms_measure(ms, fa, fb, batch_size, num_batches)) {
    err(ms, "Failed to measure. Reason: %s.");
    return 1;
  }
  const char *output = NULL;
  size_t jsonlen = 0;
  ms_getJson(ms, &output, &jsonlen);
  printf("%s\n", output);

  // Require to have true in the string but not false
  if (strstr(output, "true") == NULL && strstr(output, "false") != NULL) {
    fprintf(stderr, "should have been a correct result\n");
    ms_measure_end(ms);
    return 1;
  }
  // END
  if (ms_measure_end(ms)) {
    err(ms, "Failed to measure_end. Reason: %s.");
    return 1;
  }
  return 0;
}
