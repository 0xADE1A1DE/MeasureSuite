/**
 * Copyright 2022 University of Adelaide
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#include "helper.h"
#include <measuresuite.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>

const char symbol[] = {"fiat_p521_carry_square"};
const int arg_width = 9;
const int arg_num_in = 1;

int main() {
  SIGILL_SETUP();

  char fa[] = {
      "SECTION .text\n"
      "	GLOBAL square_p521\n"
      "square_p521:\n"
      "sub rsp, 0x158 \n"
      "mov [ rsp + 0x120 ], rbx; saving to stack\n"
      "mov [ rsp + 0x128 ], rbp; saving to stack\n"
      "mov [ rsp + 0x130 ], r12; saving to stack\n"
      "mov [ rsp + 0x138 ], r13; saving to stack\n"
      "mov [ rsp + 0x140 ], r14; saving to stack\n"
      "mov [ rsp + 0x148 ], r15; saving to stack\n"
      "mov r10, [ rsi + 0x40 ]; load m64 x1 to register64\n"
      "imul rdx, r10, 0x2; x2 <- x1 * 0x2\n"
      "imul rdx, rdx, 0x2; x10001 <- x2 * 0x2\n"
      "mov r9, [ rsi + 0x38 ]; load m64 x4 to register64\n"
      "mov r13, rdx; preserving value of x10001 into a new reg\n"
      "mov rdx, [ rsi + 0x0 ]; saving arg1[0] in rdx.\n"
      "mulx r14, r15, [ rsi + 0x0 ]; x106, x105<- arg1[0] * arg1[0]\n"
      "mov rdx, [ rsi + 0x8 ]; arg1[1] to rdx\n"
      "mulx r12, r11, r13; x74, x73<- arg1[1] * x10001\n"
      "imul rax, r9, 0x2; x5 <- x4 * 0x2\n"
      "imul rax, rax, 0x2; x10003 <- x5 * 0x2\n"
      "mov rdx, [ rsi + 0x10 ]; arg1[2] to rdx\n"
      "mulx rbp, r8, rax; x62, x61<- arg1[2] * x10003\n"
      "mov rdx, [ rsi + 0x30 ]; load m64 x7 to register64\n"
      "imul rcx, rdx, 0x2; x8 <- x7 * 0x2\n"
      "imul rcx, rcx, 0x2; x10005 <- x8 * 0x2\n"
      "mov rbx, [ rsi + 0x28 ]; load m64 x10 to register64\n"
      "xchg rdx, rcx; x10005, swapping with x7, which is currently in rdx\n"
      "mov [ rsp + 0x0 ], r8; spilling x61 to mem\n"
      "mov [ rsp + 0x8 ], rbp; spilling x62 to mem\n"
      "mulx r8, rbp, [ rsi + 0x18 ]; x52, x51<- arg1[3] * x10005\n"
      "mov [ rsp + 0x10 ], rcx; spilling x7 to mem\n"
      "imul rcx, rbx, 0x2; x11 <- x10 * 0x2\n"
      "imul rcx, rcx, 0x2; x10007 <- x11 * 0x2\n"
      "mov [ rsp + 0x18 ], r10; spilling x1 to mem\n"
      "mov r10, rdx; preserving value of x10005 into a new reg\n"
      "mov rdx, [ rsi + 0x20 ]; saving arg1[4] in rdx.\n"
      "mov [ rsp + 0x20 ], rdi; spilling out1 to mem\n"
      "mulx rcx, rdi, rcx; x44, x43<- arg1[4] * x10007\n"
      "add rdi, rbp; could be done better, if r0 has been u8 as well\n"
      "mov rdx, -0x2 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rdi, [ rsp + 0x0 ]\n"
      "seto dl; spill OF x112 to reg (rdx)\n"
      "mov rbp, -0x2 ; moving imm to reg\n"
      "inc rbp; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rdi, r11\n"
      "seto bpl; spill OF x116 to reg (rbp)\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rdi, r15\n"
      "mov r11, 0x3ffffffffffffff ; moving imm to reg\n"
      "setc r15b; spill CF x108 to reg (r15)\n"
      "mov [ rsp + 0x28 ], rcx; spilling x44 to mem\n"
      "seto cl; spill OF x120 to reg (rcx)\n"
      "mov [ rsp + 0x30 ], rax; spilling x10003 to mem\n"
      "mov rax, rdi; x125, copying x119 here, cause x119 is needed in a reg "
      "for "
      "other than x125, namely all: , x123, x125, size: 2\n"
      "and rax, r11; x125 <- x119& 0x3ffffffffffffff\n"
      "sar  r15b, 1\n"
      "adcx r8, [ rsp + 0x28 ]\n"
      "sar  dl, 1\n"
      "adcx r8, [ rsp + 0x8 ]\n"
      "sar  bpl, 1\n"
      "adcx r12, r8\n"
      "sar  cl, 1\n"
      "adcx r14, r12\n"
      "shrd rdi, r14, 58; x123 <- x121||x119 >> 58\n"
      "imul r15, [ rsi + 0x8 ], 0x2; x16 <- arg1[1] * 0x2\n"
      "mov rdx, [ rsp + 0x30 ]; x10003 to rdx\n"
      "mulx rbp, rcx, [ rsi + 0x18 ]; x50, x49<- arg1[3] * x10003\n"
      "mov r8, rdx; preserving value of x10003 into a new reg\n"
      "mov rdx, [ rsi + 0x0 ]; saving arg1[0] in rdx.\n"
      "mulx r15, r12, r15; x104, x103<- arg1[0] * x16\n"
      "mov rdx, [ rsi + 0x10 ]; arg1[2] to rdx\n"
      "mov [ rsp + 0x38 ], r14; spilling x121 to mem\n"
      "mulx r11, r14, r13; x60, x59<- arg1[2] * x10001\n"
      "mov rdx, r10; x10005 to rdx\n"
      "mov [ rsp + 0x40 ], rdi; spilling x123 to mem\n"
      "mulx r10, rdi, [ rsi + 0x20 ]; x42, x41<- arg1[4] * x10005\n"
      "imul rbx, rbx, 0x2; x10006 <- x10 * 0x2\n"
      "xchg rdx, rbx; x10006, swapping with x10005, which is currently in rdx\n"
      "mov [ rsp + 0x30 ], r8; spilling x10003 to mem\n"
      "mulx rdx, r8, [ rsi + 0x28 ]; x36, x35<- arg1[5] * x10006\n"
      "mov [ rsp + 0x48 ], rdx; spilling x36 to mem\n"
      "xor rdx, rdx\n"
      "adox r8, rdi\n"
      "adcx r8, rcx\n"
      "setc cl; spill CF x243 to reg (rcx)\n"
      "clc;\n"
      "adcx r8, r14\n"
      "seto r14b; spill OF x239 to reg (r14)\n"
      "mov rdi, -0x2 ; moving imm to reg\n"
      "inc rdi; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r8, r12\n"
      "seto r12b; spill OF x251 to reg (r12)\n"
      "mov [ rsp + 0x50 ], rax; spilling x125 to mem\n"
      "mov rax, -0x2 ; moving imm to reg\n"
      "inc rax; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r8, [ rsp + 0x40 ]\n"
      "movzx r14, r14b\n"
      "lea r10, [ r14 + r10 ]\n"
      "mov r14, [ rsp + 0x48 ]\n"
      "lea r10, [r14+r10]\n"
      "setc al; spill CF x247 to reg (rax)\n"
      "seto r14b; spill OF x255 to reg (r14)\n"
      "mov rdx, [ rsp + 0x38 ]; x124, copying x121 here, cause x121 is needed "
      "in "
      "a reg for other than x124, namely all: , x124, size: 1\n"
      "shr rdx, 58; x124 <- x121>> 58\n"
      "sar  cl, 1\n"
      "adcx rbp, r10\n"
      "sar  al, 1\n"
      "adcx r11, rbp\n"
      "sar  r12b, 1\n"
      "adcx r15, r11\n"
      "imul rcx, [ rsi + 0x10 ], 0x2; x15 <- arg1[2] * 0x2\n"
      "sar  r14b, 1\n"
      "adcx rdx, r15\n"
      "xchg rdx, rcx; x15, swapping with x256, which is currently in rdx\n"
      "mulx rax, r12, [ rsi + 0x0 ]; x102, x101<- arg1[0] * x15\n"
      "mov r14, r8; x258, copying x254 here, cause x254 is needed in a reg for "
      "other than x258, namely all: , x260, x258, size: 2\n"
      "shrd r14, rcx, 58; x258 <- x256||x254 >> 58\n"
      "mov r10, rdx; preserving value of x15 into a new reg\n"
      "mov rdx, [ rsi + 0x8 ]; saving arg1[1] in rdx.\n"
      "mulx rbp, r11, [ rsi + 0x8 ]; x88, x87<- arg1[1] * arg1[1]\n"
      "mov rdx, [ rsp + 0x30 ]; x10003 to rdx\n"
      "mov [ rsp + 0x58 ], r14; spilling x258 to mem\n"
      "mulx r15, r14, [ rsi + 0x20 ]; x40, x39<- arg1[4] * x10003\n"
      "mov [ rsp + 0x60 ], r8; spilling x254 to mem\n"
      "mov r8, rdx; preserving value of x10003 into a new reg\n"
      "mov rdx, [ rsi + 0x18 ]; saving arg1[3] in rdx.\n"
      "mov [ rsp + 0x68 ], r12; spilling x101 to mem\n"
      "mov [ rsp + 0x70 ], rax; spilling x102 to mem\n"
      "mulx r12, rax, r13; x48, x47<- arg1[3] * x10001\n"
      "mov rdx, rbx; x10005 to rdx\n"
      "mulx rdx, rbx, [ rsi + 0x28 ]; x34, x33<- arg1[5] * x10005\n"
      "mov [ rsp + 0x30 ], r8; spilling x10003 to mem\n"
      "xor r8, r8\n"
      "adox rbx, r14\n"
      "adcx rbx, rax\n"
      "seto r14b; spill OF x223 to reg (r14)\n"
      "mov rax, -0x2 ; moving imm to reg\n"
      "inc rax; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbx, r11\n"
      "setc al; spill CF x227 to reg (rax)\n"
      "seto r11b; spill OF x231 to reg (r11)\n"
      "shr rcx, 58; x259 <- x256>> 58\n"
      "test al, al\n"
      "adox rbx, [ rsp + 0x68 ]\n"
      "movzx r14, r14b\n"
      "lea r15, [ r15 + rdx ]\n"
      "lea r15, [ r15 + r14 ]\n"
      "adcx rbx, [ rsp + 0x58 ]\n"
      "movzx rax, al\n"
      "lea r12, [ r12 + r15 ]\n"
      "lea r12, [ r12 + rax ]\n"
      "movzx r11, r11b\n"
      "lea rbp, [ rbp + r12 ]\n"
      "lea rbp, [ rbp + r11 ]\n"
      "adox rbp, [ rsp + 0x70 ]\n"
      "adcx rcx, rbp\n"
      "mov rdx, rbx; x265, copying x261 here, cause x261 is needed in a reg "
      "for "
      "other than x265, namely all: , x267, x265, size: 2\n"
      "shrd rdx, rcx, 58; x265 <- x263||x261 >> 58\n"
      "imul r14, [ rsi + 0x18 ], 0x2; x14 <- arg1[3] * 0x2\n"
      "mov rax, rdx; preserving value of x265 into a new reg\n"
      "mov rdx, [ rsi + 0x8 ]; saving arg1[1] in rdx.\n"
      "mulx r10, r11, r10; x86, x85<- arg1[1] * x15\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r15, r12, r14; x100, x99<- arg1[0] * x14\n"
      "mov rdx, [ rsi + 0x28 ]; arg1[5] to rdx\n"
      "mulx rbp, r8, [ rsp + 0x30 ]; x32, x31<- arg1[5] * x10003\n"
      "mov rdx, r13; x10001 to rdx\n"
      "mov [ rsp + 0x78 ], rbx; spilling x261 to mem\n"
      "mulx r13, rbx, [ rsi + 0x20 ]; x38, x37<- arg1[4] * x10001\n"
      "mov [ rsp + 0x80 ], r14; spilling x14 to mem\n"
      "imul r14, [ rsp + 0x10 ], 0x2; x10004 <- x7 * 0x2\n"
      "xchg rdx, r14; x10004, swapping with x10001, which is currently in rdx\n"
      "mov [ rsp + 0x88 ], r15; spilling x100 to mem\n"
      "mulx rdx, r15, [ rsi + 0x30 ]; x28, x27<- arg1[6] * x10004\n"
      "test al, al\n"
      "adox r15, r8\n"
      "adcx r15, rbx\n"
      "seto r8b; spill OF x207 to reg (r8)\n"
      "mov rbx, -0x2 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r15, r11\n"
      "seto bl; spill OF x215 to reg (rbx)\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r15, r12\n"
      "movzx r8, r8b\n"
      "lea rbp, [ rbp + rdx ]\n"
      "lea rbp, [ rbp + r8 ]\n"
      "seto r11b; spill OF x219 to reg (r11)\n"
      "mov r12, -0x2 ; moving imm to reg\n"
      "inc r12; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r15, rax\n"
      "setc r12b; spill CF x211 to reg (r12)\n"
      "seto al; spill OF x269 to reg (rax)\n"
      "shr rcx, 58; x266 <- x263>> 58\n"
      "sar  r12b, 1\n"
      "adcx r13, rbp\n"
      "sar  bl, 1\n"
      "adcx r10, r13\n"
      "sar  r11b, 1\n"
      "adcx r10, [ rsp + 0x88 ]\n"
      "sar  al, 1\n"
      "adcx rcx, r10\n"
      "imul rdx, [ rsi + 0x20 ], 0x2; x13 <- arg1[4] * 0x2\n"
      "mulx r8, r12, [ rsi + 0x0 ]; x98, x97<- arg1[0] * x13\n"
      "mov rbx, r15; x272, copying x268 here, cause x268 is needed in a reg "
      "for "
      "other than x272, namely all: , x274, x272, size: 2\n"
      "shrd rbx, rcx, 58; x272 <- x270||x268 >> 58\n"
      "mov r11, rdx; preserving value of x13 into a new reg\n"
      "mov rdx, [ rsi + 0x10 ]; saving arg1[2] in rdx.\n"
      "mulx rbp, rax, [ rsi + 0x10 ]; x72, x71<- arg1[2] * arg1[2]\n"
      "mov rdx, [ rsp + 0x80 ]; x14 to rdx\n"
      "mulx r13, r10, [ rsi + 0x8 ]; x84, x83<- arg1[1] * x14\n"
      "mov [ rsp + 0x90 ], rbx; spilling x272 to mem\n"
      "mov rbx, rdx; preserving value of x14 into a new reg\n"
      "mov rdx, [ rsi + 0x28 ]; saving arg1[5] in rdx.\n"
      "mov [ rsp + 0x98 ], r15; spilling x268 to mem\n"
      "mov [ rsp + 0xa0 ], r11; spilling x13 to mem\n"
      "mulx r15, r11, r14; x30, x29<- arg1[5] * x10001\n"
      "mov rdx, [ rsp + 0x30 ]; x10003 to rdx\n"
      "mov [ rsp + 0x80 ], rbx; spilling x14 to mem\n"
      "mulx rdx, rbx, [ rsi + 0x30 ]; x26, x25<- arg1[6] * x10003\n"
      "mov [ rsp + 0xa8 ], r9; spilling x4 to mem\n"
      "xor r9, r9\n"
      "adox rbx, r11\n"
      "adcx rbx, rax\n"
      "seto al; spill OF x191 to reg (rax)\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbx, r10\n"
      "setc r11b; spill CF x195 to reg (r11)\n"
      "clc;\n"
      "adcx rbx, r12\n"
      "setc r12b; spill CF x203 to reg (r12)\n"
      "clc;\n"
      "adcx rbx, [ rsp + 0x90 ]\n"
      "movzx rax, al\n"
      "lea r15, [ r15 + rdx ]\n"
      "lea r15, [ r15 + rax ]\n"
      "movzx r11, r11b\n"
      "lea rbp, [ rbp + r15 ]\n"
      "lea rbp, [ rbp + r11 ]\n"
      "setc r10b; spill CF x276 to reg (r10)\n"
      "seto dl; spill OF x199 to reg (rdx)\n"
      "shr rcx, 58; x273 <- x270>> 58\n"
      "sar  dl, 1\n"
      "adcx r13, rbp\n"
      "sar  r12b, 1\n"
      "adcx r8, r13\n"
      "imul rax, [ rsi + 0x28 ], 0x2; x12 <- arg1[5] * 0x2\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r11, r12, rax; x96, x95<- arg1[0] * x12\n"
      "sar  r10b, 1\n"
      "adcx rcx, r8\n"
      "mov rdx, [ rsp + 0xa0 ]; x13 to rdx\n"
      "mulx r10, r15, [ rsi + 0x8 ]; x82, x81<- arg1[1] * x13\n"
      "mov rbp, rbx; x279, copying x275 here, cause x275 is needed in a reg "
      "for "
      "other than x279, namely all: , x279, x281, size: 2\n"
      "shrd rbp, rcx, 58; x279 <- x277||x275 >> 58\n"
      "mov r13, rdx; preserving value of x13 into a new reg\n"
      "mov rdx, [ rsp + 0x80 ]; saving x14 in rdx.\n"
      "mulx rdx, r8, [ rsi + 0x10 ]; x70, x69<- arg1[2] * x14\n"
      "xchg rdx, r14; x10001, swapping with x70, which is currently in rdx\n"
      "mov [ rsp + 0xb0 ], rbx; spilling x275 to mem\n"
      "mulx r9, rbx, [ rsi + 0x30 ]; x24, x23<- arg1[6] * x10001\n"
      "mov [ rsp + 0xb8 ], rbx; spilling x23 to mem\n"
      "imul rbx, [ rsp + 0xa8 ], 0x2; x10002 <- x4 * 0x2\n"
      "xchg rdx, rbx; x10002, swapping with x10001, which is currently in rdx\n"
      "mov [ rsp + 0xc0 ], r11; spilling x96 to mem\n"
      "mulx rdx, r11, [ rsi + 0x38 ]; x22, x21<- arg1[7] * x10002\n"
      "mov [ rsp + 0xc8 ], r14; spilling x70 to mem\n"
      "xor r14, r14\n"
      "adox r11, [ rsp + 0xb8 ]\n"
      "adcx r11, r8\n"
      "seto r8b; spill OF x175 to reg (r8)\n"
      "mov [ rsp + 0xa0 ], r13; spilling x13 to mem\n"
      "mov r13, -0x2 ; moving imm to reg\n"
      "inc r13; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r11, r15\n"
      "setc r13b; spill CF x179 to reg (r13)\n"
      "clc;\n"
      "adcx r11, r12\n"
      "seto r12b; spill OF x183 to reg (r12)\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r11, rbp\n"
      "setc r15b; spill CF x187 to reg (r15)\n"
      "seto bpl; spill OF x283 to reg (rbp)\n"
      "shr rcx, 58; x280 <- x277>> 58\n"
      "sar  r8b, 1\n"
      "adcx r9, rdx\n"
      "sar  r13b, 1\n"
      "adcx r9, [ rsp + 0xc8 ]\n"
      "sar  r12b, 1\n"
      "adcx r10, r9\n"
      "imul rdx, [ rsi + 0x30 ], 0x2; x9 <- arg1[6] * 0x2\n"
      "sar  r15b, 1\n"
      "adcx r10, [ rsp + 0xc0 ]\n"
      "sar  bpl, 1\n"
      "adcx rcx, r10\n"
      "mov r8, r11; x286, copying x282 here, cause x282 is needed in a reg for "
      "other than x286, namely all: , x286, x288, size: 2\n"
      "shrd r8, rcx, 58; x286 <- x284||x282 >> 58\n"
      "mov r13, rdx; preserving value of x9 into a new reg\n"
      "mov rdx, [ rsi + 0x38 ]; saving arg1[7] in rdx.\n"
      "mulx rbx, r12, rbx; x20, x19<- arg1[7] * x10001\n"
      "mov rdx, [ rsi + 0x8 ]; arg1[1] to rdx\n"
      "mulx r15, rbp, rax; x80, x79<- arg1[1] * x12\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r9, r10, r13; x94, x93<- arg1[0] * x9\n"
      "mov rdx, [ rsi + 0x18 ]; arg1[3] to rdx\n"
      "mov [ rsp + 0xd0 ], r11; spilling x282 to mem\n"
      "mulx r14, r11, [ rsi + 0x18 ]; x58, x57<- arg1[3] * arg1[3]\n"
      "xor rdx, rdx\n"
      "adox r12, r11\n"
      "mov r11, rdx; preserving value of 0x0 into a new reg\n"
      "mov rdx, [ rsp + 0xa0 ]; saving x13 in rdx.\n"
      "mov [ rsp + 0xd8 ], r15; spilling x80 to mem\n"
      "mov [ rsp + 0xe0 ], rbx; spilling x20 to mem\n"
      "mulx r15, rbx, [ rsi + 0x10 ]; x68, x67<- arg1[2] * x13\n"
      "adcx r12, rbx\n"
      "setc bl; spill CF x163 to reg (rbx)\n"
      "clc;\n"
      "adcx r12, rbp\n"
      "setc bpl; spill CF x167 to reg (rbp)\n"
      "seto r11b; spill OF x159 to reg (r11)\n"
      "shr rcx, 58; x287 <- x284>> 58\n"
      "mov byte [ rsp + 0xe8 ], bl; spilling byte x163 to mem\n"
      "xor rbx, rbx\n"
      "adox r12, r10\n"
      "movzx r11, r11b\n"
      "lea r14, [ r11 + r14 ]\n"
      "adcx r14, [ rsp + 0xe0 ]\n"
      "clc;\n"
      "adcx r12, r8\n"
      "movzx r8, byte [ rsp + 0xe8 ]; load byte memx163 to register64\n"
      "lea r15, [ r15 + r14 ]\n"
      "lea r15, [ r15 + r8 ]\n"
      "movzx rbp, bpl\n"
      "lea r15, [ rbp + r15 ]\n"
      "mov rbp, [ rsp + 0xd8 ]\n"
      "lea r15, [rbp+r15]\n"
      "adox r9, r15\n"
      "adcx rcx, r9\n"
      "mov r10, r12; x293, copying x289 here, cause x289 is needed in a reg "
      "for "
      "other than x293, namely all: , x293, x295, size: 2\n"
      "shrd r10, rcx, 58; x293 <- x291||x289 >> 58\n"
      "imul r11, [ rsi + 0x38 ], 0x2; x6 <- arg1[7] * 0x2\n"
      "xchg rdx, r11; x6, swapping with x13, which is currently in rdx\n"
      "mulx r8, rbp, [ rsi + 0x0 ]; x92, x91<- arg1[0] * x6\n"
      "mov r14, rdx; preserving value of x6 into a new reg\n"
      "mov rdx, [ rsi + 0x8 ]; saving arg1[1] in rdx.\n"
      "mulx r15, r9, r13; x78, x77<- arg1[1] * x9\n"
      "imul rdx, [ rsp + 0x18 ], 0x2; x10000 <- x1 * 0x2\n"
      "mov rbx, rdx; preserving value of x10000 into a new reg\n"
      "mov rdx, [ rsi + 0x10 ]; saving arg1[2] in rdx.\n"
      "mov [ rsp + 0xf0 ], rbp; spilling x91 to mem\n"
      "mov [ rsp + 0xf8 ], r15; spilling x78 to mem\n"
      "mulx rbp, r15, rax; x66, x65<- arg1[2] * x12\n"
      "mov rdx, [ rsi + 0x18 ]; arg1[3] to rdx\n"
      "mov [ rsp + 0x100 ], r10; spilling x293 to mem\n"
      "mulx r11, r10, r11; x56, x55<- arg1[3] * x13\n"
      "mov rdx, [ rsi + 0x40 ]; arg1[8] to rdx\n"
      "mov [ rsp + 0x108 ], r14; spilling x6 to mem\n"
      "mulx rbx, r14, rbx; x18, x17<- arg1[8] * x10000\n"
      "test al, al\n"
      "adox r14, r10\n"
      "adcx r14, r15\n"
      "setc dl; spill CF x147 to reg (rdx)\n"
      "clc;\n"
      "adcx r14, r9\n"
      "setc r9b; spill CF x151 to reg (r9)\n"
      "clc;\n"
      "adcx r14, [ rsp + 0xf0 ]\n"
      "seto r15b; spill OF x143 to reg (r15)\n"
      "mov r10, -0x2 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r14, [ rsp + 0x100 ]\n"
      "movzx r15, r15b\n"
      "lea r11, [ r11 + rbx ]\n"
      "lea r11, [ r11 + r15 ]\n"
      "setc r10b; spill CF x155 to reg (r10)\n"
      "seto bl; spill OF x297 to reg (rbx)\n"
      "shr rcx, 58; x294 <- x291>> 58\n"
      "sar  dl, 1\n"
      "adcx rbp, r11\n"
      "sar  r9b, 1\n"
      "adcx rbp, [ rsp + 0xf8 ]\n"
      "sar  r10b, 1\n"
      "adcx r8, rbp\n"
      "sar  bl, 1\n"
      "adcx rcx, r8\n"
      "imul r15, [ rsi + 0x40 ], 0x2; x3 <- arg1[8] * 0x2\n"
      "mov rdx, r14; x300, copying x296 here, cause x296 is needed in a reg "
      "for "
      "other than x300, namely all: , x302, x300, size: 2\n"
      "shrd rdx, rcx, 58; x300 <- x298||x296 >> 58\n"
      "xchg rdx, r13; x9, swapping with x300, which is currently in rdx\n"
      "mulx rdx, r9, [ rsi + 0x10 ]; x64, x63<- arg1[2] * x9\n"
      "mov r10, rdx; preserving value of x64 into a new reg\n"
      "mov rdx, [ rsi + 0x0 ]; saving arg1[0] in rdx.\n"
      "mulx r15, rbx, r15; x90, x89<- arg1[0] * x3\n"
      "mov rdx, [ rsp + 0x108 ]; x6 to rdx\n"
      "mulx rdx, r11, [ rsi + 0x8 ]; x76, x75<- arg1[1] * x6\n"
      "mov rbp, rdx; preserving value of x76 into a new reg\n"
      "mov rdx, [ rsi + 0x20 ]; saving arg1[4] in rdx.\n"
      "mov [ rsp + 0x110 ], r10; spilling x64 to mem\n"
      "mulx r8, r10, [ rsi + 0x20 ]; x46, x45<- arg1[4] * arg1[4]\n"
      "mov rdx, [ rsi + 0x18 ]; arg1[3] to rdx\n"
      "mov [ rsp + 0x118 ], rbx; spilling x89 to mem\n"
      "mulx rax, rbx, rax; x54, x53<- arg1[3] * x12\n"
      "xor rdx, rdx\n"
      "adox r10, rbx\n"
      "adcx r10, r9\n"
      "seto r9b; spill OF x127 to reg (r9)\n"
      "mov rbx, -0x2 ; moving imm to reg\n"
      "inc rbx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, r11\n"
      "seto bl; spill OF x135 to reg (rbx)\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, [ rsp + 0x118 ]\n"
      "movzx r9, r9b\n"
      "lea rax, [ rax + r8 ]\n"
      "lea rax, [ rax + r9 ]\n"
      "seto r11b; spill OF x139 to reg (r11)\n"
      "mov r8, -0x2 ; moving imm to reg\n"
      "inc r8; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, r13\n"
      "setc r8b; spill CF x131 to reg (r8)\n"
      "seto r13b; spill OF x304 to reg (r13)\n"
      "shr rcx, 58; x301 <- x298>> 58\n"
      "sar  r8b, 1\n"
      "adcx rax, [ rsp + 0x110 ]\n"
      "sar  bl, 1\n"
      "adcx rbp, rax\n"
      "sar  r11b, 1\n"
      "adcx r15, rbp\n"
      "sar  r13b, 1\n"
      "adcx rcx, r15\n"
      "mov r9, r10; x307, copying x303 here, cause x303 is needed in a reg for "
      "other than x307, namely all: , x309, x307, size: 2\n"
      "shrd r9, rcx, 57; x307 <- x305||x303 >> 57\n"
      "shr rcx, 57; x308 <- x305>> 57\n"
      "xor r8, r8\n"
      "adox r9, [ rsp + 0x50 ]\n"
      "adox rcx, r8\n"
      "mov rdx, r9; x313, copying x310 here, cause x310 is needed in a reg for "
      "other than x313, namely all: , x313, x314, size: 2\n"
      "shrd rdx, rcx, 58; x313 <- x312||x310 >> 58\n"
      "mov rbx, 0x3ffffffffffffff ; moving imm to reg\n"
      "and r14, rbx; x302 <- x296& 0x3ffffffffffffff\n"
      "mov r11, [ rsp + 0x60 ]; x260, copying x254 here, cause x254 is needed "
      "in "
      "a reg for other than x260, namely all: , x260, size: 1\n"
      "and r11, rbx; x260 <- x254& 0x3ffffffffffffff\n"
      "lea rdx, [ rdx + r11 ]\n"
      "mov r13, 0x1ffffffffffffff ; moving imm to reg\n"
      "and r10, r13; x309 <- x303& 0x1ffffffffffffff\n"
      "mov rax, rdx; x317, copying x315 here, cause x315 is needed in a reg "
      "for "
      "other than x317, namely all: , x317, x316, size: 2\n"
      "and rax, rbx; x317 <- x315& 0x3ffffffffffffff\n"
      "mov rbp, [ rsp + 0x20 ]; load m64 out1 to register64\n"
      "mov [ rbp + 0x40 ], r10; out1[8] = x309\n"
      "shr rdx, 58; x316 <- x315>> 58\n"
      "mov r15, [ rsp + 0x78 ]; x267, copying x261 here, cause x261 is needed "
      "in "
      "a reg for other than x267, namely all: , x267, size: 1\n"
      "and r15, rbx; x267 <- x261& 0x3ffffffffffffff\n"
      "mov rcx, [ rsp + 0x98 ]; x274, copying x268 here, cause x268 is needed "
      "in "
      "a reg for other than x274, namely all: , x274, size: 1\n"
      "and rcx, rbx; x274 <- x268& 0x3ffffffffffffff\n"
      "mov [ rbp + 0x18 ], rcx; out1[3] = x274\n"
      "lea rdx, [ rdx + r15 ]\n"
      "mov r11, [ rsp + 0xb0 ]; x281, copying x275 here, cause x275 is needed "
      "in "
      "a reg for other than x281, namely all: , x281, size: 1\n"
      "and r11, rbx; x281 <- x275& 0x3ffffffffffffff\n"
      "mov [ rbp + 0x20 ], r11; out1[4] = x281\n"
      "and r9, rbx; x314 <- x310& 0x3ffffffffffffff\n"
      "mov [ rbp + 0x0 ], r9; out1[0] = x314\n"
      "and r12, rbx; x295 <- x289& 0x3ffffffffffffff\n"
      "mov r10, [ rsp + 0xd0 ]; x288, copying x282 here, cause x282 is needed "
      "in "
      "a reg for other than x288, namely all: , x288, size: 1\n"
      "and r10, rbx; x288 <- x282& 0x3ffffffffffffff\n"
      "mov [ rbp + 0x30 ], r12; out1[6] = x295\n"
      "mov [ rbp + 0x8 ], rax; out1[1] = x317\n"
      "mov [ rbp + 0x28 ], r10; out1[5] = x288\n"
      "mov [ rbp + 0x38 ], r14; out1[7] = x302\n"
      "mov [ rbp + 0x10 ], rdx; out1[2] = x318\n"
      "mov rbx, [ rsp + 0x120 ]; restoring from stack\n"
      "mov rbp, [ rsp + 0x128 ]; restoring from stack\n"
      "mov r12, [ rsp + 0x130 ]; restoring from stack\n"
      "mov r13, [ rsp + 0x138 ]; restoring from stack\n"
      "mov r14, [ rsp + 0x140 ]; restoring from stack\n"
      "mov r15, [ rsp + 0x148 ]; restoring from stack\n"
      "add rsp, 0x158 \n"
      "ret\n"
      "; cpu Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz\n"
      "; clocked at 2327 MHz\n"
      "; first cyclecount 9172, last 8509.5\n"
      "; seed 1617678978 \n"
      "; time needed: 12100638 ms / 100000 runs=> 121.00638ms/run\n"
      "; Time spent for assembling and measureing (r=200,e=100): 1639630 ms\n"
      "; Ratio (time for assembling + measure)/(total runtime for 100000runs): "
      "0.13549946705289423\n"
      "; number reverted permutation/ tried permutation: 27770 / 27867 "
      "=0.996519180392579\n"
      "; number reverted spill/ tried spill: 27437 / 27546 "
      "=0.9960429826472083\n"
      "; number reverted decision/ tried decision: 27500 / 27587 "
      "=0.9968463406677058\n"
      "; FailedEvals (cannot swap because of edge to the next node): 22437\n"};

  char fb[] = {
      "SECTION .text\n"
      "	GLOBAL square_p521\n"
      "square_p521:\n"
      "sub rsp, 0x138 \n"
      "mov [ rsp + 0x100 ], rbx; saving to stack\n"
      "mov [ rsp + 0x108 ], rbp; saving to stack\n"
      "mov [ rsp + 0x110 ], r12; saving to stack\n"
      "mov [ rsp + 0x118 ], r13; saving to stack\n"
      "mov [ rsp + 0x120 ], r14; saving to stack\n"
      "mov [ rsp + 0x128 ], r15; saving to stack\n"
      "mov r11, [ rsi + 0x40 ]; load m64 x1 to register64\n"
      "imul r10, r11, 0x2; x2 <- x1 * 0x2\n"
      "imul r10, r10, 0x2; x10001 <- x2 * 0x2\n"
      "mov rbx, [ rsi + 0x38 ]; load m64 x4 to register64\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r14, rbp, [ rsi + 0x0 ]; x106, x105<- arg1[0] * arg1[0]\n"
      "mov rdx, r10; x10001 to rdx\n"
      "mulx rcx, r12, [ rsi + 0x8 ]; x74, x73<- arg1[1] * x10001\n"
      "imul rax, rbx, 0x2; x5 <- x4 * 0x2\n"
      "imul rax, rax, 0x2; x10003 <- x5 * 0x2\n"
      "xchg rdx, rax; x10003, swapping with x10001, which is currently in rdx\n"
      "mulx r9, r8, [ rsi + 0x10 ]; x62, x61<- arg1[2] * x10003\n"
      "mov r15, [ rsi + 0x30 ]; load m64 x7 to register64\n"
      "imul r13, r15, 0x2; x8 <- x7 * 0x2\n"
      "imul r13, r13, 0x2; x10005 <- x8 * 0x2\n"
      "mov r10, [ rsi + 0x28 ]; load m64 x10 to register64\n"
      "mov [ rsp + 0x0 ], r8; spilling x61 to mem\n"
      "mov r8, rdx; preserving value of x10003 into a new reg\n"
      "mov rdx, [ rsi + 0x18 ]; saving arg1[3] in rdx.\n"
      "mov [ rsp + 0x8 ], r9; spilling x62 to mem\n"
      "mov [ rsp + 0x10 ], r15; spilling x7 to mem\n"
      "mulx r9, r15, r13; x52, x51<- arg1[3] * x10005\n"
      "imul rdx, r10, 0x2; x11 <- x10 * 0x2\n"
      "imul rdx, rdx, 0x2; x10007 <- x11 * 0x2\n"
      "mov [ rsp + 0x18 ], r11; spilling x1 to mem\n"
      "mulx rdx, r11, [ rsi + 0x20 ]; x44, x43<- arg1[4] * x10007\n"
      "test al, al\n"
      "adox r11, r15\n"
      "adcx r11, [ rsp + 0x0 ]\n"
      "seto r15b; spill OF x108 to reg (r15)\n"
      "mov [ rsp + 0x20 ], rdx; spilling x44 to mem\n"
      "mov rdx, -0x2 ; moving imm to reg\n"
      "inc rdx; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r11, r12\n"
      "setc dl; spill CF x112 to reg (rdx)\n"
      "clc;\n"
      "adcx r11, rbp\n"
      "mov rbp, 0x3ffffffffffffff ; moving imm to reg\n"
      "setc r12b; spill CF x120 to reg (r12)\n"
      "mov [ rsp + 0x28 ], rdi; spilling out1 to mem\n"
      "seto dil; spill OF x116 to reg (rdi)\n"
      "mov [ rsp + 0x30 ], r8; spilling x10003 to mem\n"
      "mov r8, r11; x125, copying x119 here, cause x119 is needed in a reg for "
      "other than x125, namely all: , x123, x125, size: 2\n"
      "and r8, rbp; x125 <- x119& 0x3ffffffffffffff\n"
      "sar  r15b, 1\n"
      "adcx r9, [ rsp + 0x20 ]\n"
      "sar  dl, 1\n"
      "adcx r9, [ rsp + 0x8 ]\n"
      "sar  dil, 1\n"
      "adcx rcx, r9\n"
      "sar  r12b, 1\n"
      "adcx r14, rcx\n"
      "shrd r11, r14, 58; x123 <- x121||x119 >> 58\n"
      "imul r15, [ rsi + 0x8 ], 0x2; x16 <- arg1[1] * 0x2\n"
      "mov rdx, [ rsi + 0x18 ]; arg1[3] to rdx\n"
      "mulx rdi, r12, [ rsp + 0x30 ]; x50, x49<- arg1[3] * x10003\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r15, r9, r15; x104, x103<- arg1[0] * x16\n"
      "mov rdx, [ rsi + 0x10 ]; arg1[2] to rdx\n"
      "mulx rcx, rbp, rax; x60, x59<- arg1[2] * x10001\n"
      "mov rdx, r13; x10005 to rdx\n"
      "mov [ rsp + 0x38 ], r11; spilling x123 to mem\n"
      "mulx r13, r11, [ rsi + 0x20 ]; x42, x41<- arg1[4] * x10005\n"
      "imul r10, r10, 0x2; x10006 <- x10 * 0x2\n"
      "mov [ rsp + 0x40 ], r8; spilling x125 to mem\n"
      "mov r8, rdx; preserving value of x10005 into a new reg\n"
      "mov rdx, [ rsi + 0x28 ]; saving arg1[5] in rdx.\n"
      "mov [ rsp + 0x48 ], rbx; spilling x4 to mem\n"
      "mulx r10, rbx, r10; x36, x35<- arg1[5] * x10006\n"
      "xor rdx, rdx\n"
      "adox rbx, r11\n"
      "adcx rbx, r12\n"
      "seto r12b; spill OF x239 to reg (r12)\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbx, rbp\n"
      "setc r11b; spill CF x243 to reg (r11)\n"
      "clc;\n"
      "adcx rbx, r9\n"
      "setc r9b; spill CF x251 to reg (r9)\n"
      "clc;\n"
      "adcx rbx, [ rsp + 0x38 ]\n"
      "movzx r12, r12b\n"
      "lea r13, [ r13 + r10 ]\n"
      "lea r13, [ r13 + r12 ]\n"
      "setc bpl; spill CF x255 to reg (rbp)\n"
      "seto r10b; spill OF x247 to reg (r10)\n"
      "shr r14, 58; x124 <- x121>> 58\n"
      "sar  r11b, 1\n"
      "adcx rdi, r13\n"
      "sar  r10b, 1\n"
      "adcx rcx, rdi\n"
      "sar  r9b, 1\n"
      "adcx r15, rcx\n"
      "imul r12, [ rsi + 0x10 ], 0x2; x15 <- arg1[2] * 0x2\n"
      "sar  bpl, 1\n"
      "adcx r14, r15\n"
      "mov r11, rdx; preserving value of 0x0 into a new reg\n"
      "mov rdx, [ rsi + 0x0 ]; saving arg1[0] in rdx.\n"
      "mulx r10, r9, r12; x102, x101<- arg1[0] * x15\n"
      "mov rdx, rbx; x258, copying x254 here, cause x254 is needed in a reg "
      "for "
      "other than x258, namely all: , x260, x258, size: 2\n"
      "shrd rdx, r14, 58; x258 <- x256||x254 >> 58\n"
      "mov rbp, rdx; preserving value of x258 into a new reg\n"
      "mov rdx, [ rsi + 0x8 ]; saving arg1[1] in rdx.\n"
      "mulx r13, rdi, [ rsi + 0x8 ]; x88, x87<- arg1[1] * arg1[1]\n"
      "mov rdx, [ rsi + 0x20 ]; arg1[4] to rdx\n"
      "mulx rcx, r15, [ rsp + 0x30 ]; x40, x39<- arg1[4] * x10003\n"
      "mov rdx, rax; x10001 to rdx\n"
      "mulx rax, r11, [ rsi + 0x18 ]; x48, x47<- arg1[3] * x10001\n"
      "mov [ rsp + 0x50 ], rbp; spilling x258 to mem\n"
      "mov rbp, rdx; preserving value of x10001 into a new reg\n"
      "mov rdx, [ rsi + 0x28 ]; saving arg1[5] in rdx.\n"
      "mov [ rsp + 0x58 ], rbx; spilling x254 to mem\n"
      "mulx r8, rbx, r8; x34, x33<- arg1[5] * x10005\n"
      "xor rdx, rdx\n"
      "adox rbx, r15\n"
      "adcx rbx, r11\n"
      "seto r15b; spill OF x223 to reg (r15)\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbx, rdi\n"
      "setc r11b; spill CF x227 to reg (r11)\n"
      "seto dil; spill OF x231 to reg (rdi)\n"
      "shr r14, 58; x259 <- x256>> 58\n"
      "test al, al\n"
      "adox rbx, r9\n"
      "movzx r15, r15b\n"
      "lea rcx, [ rcx + r8 ]\n"
      "lea rcx, [ rcx + r15 ]\n"
      "adcx rbx, [ rsp + 0x50 ]\n"
      "movzx r11, r11b\n"
      "lea rax, [ rax + rcx ]\n"
      "lea rax, [ rax + r11 ]\n"
      "movzx rdi, dil\n"
      "lea r13, [ r13 + rax ]\n"
      "lea r13, [ r13 + rdi ]\n"
      "adox r10, r13\n"
      "adcx r14, r10\n"
      "mov r9, rbx; x265, copying x261 here, cause x261 is needed in a reg for "
      "other than x265, namely all: , x267, x265, size: 2\n"
      "shrd r9, r14, 58; x265 <- x263||x261 >> 58\n"
      "imul r8, [ rsi + 0x18 ], 0x2; x14 <- arg1[3] * 0x2\n"
      "mov r15, rdx; preserving value of 0x0 into a new reg\n"
      "mov rdx, [ rsi + 0x8 ]; saving arg1[1] in rdx.\n"
      "mulx r12, r11, r12; x86, x85<- arg1[1] * x15\n"
      "mov rdx, r8; x14 to rdx\n"
      "mulx r8, rdi, [ rsi + 0x0 ]; x100, x99<- arg1[0] * x14\n"
      "mov rcx, rdx; preserving value of x14 into a new reg\n"
      "mov rdx, [ rsi + 0x28 ]; saving arg1[5] in rdx.\n"
      "mulx rax, r13, [ rsp + 0x30 ]; x32, x31<- arg1[5] * x10003\n"
      "mov rdx, [ rsi + 0x20 ]; arg1[4] to rdx\n"
      "mulx r10, r15, rbp; x38, x37<- arg1[4] * x10001\n"
      "imul rdx, [ rsp + 0x10 ], 0x2; x10004 <- x7 * 0x2\n"
      "mov [ rsp + 0x60 ], rbx; spilling x261 to mem\n"
      "mulx rdx, rbx, [ rsi + 0x30 ]; x28, x27<- arg1[6] * x10004\n"
      "test al, al\n"
      "adox rbx, r13\n"
      "adcx rbx, r15\n"
      "setc r13b; spill CF x211 to reg (r13)\n"
      "clc;\n"
      "adcx rbx, r11\n"
      "seto r11b; spill OF x207 to reg (r11)\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbx, rdi\n"
      "movzx r11, r11b\n"
      "lea rax, [ rax + rdx ]\n"
      "lea rax, [ rax + r11 ]\n"
      "seto r15b; spill OF x219 to reg (r15)\n"
      "mov rdi, -0x2 ; moving imm to reg\n"
      "inc rdi; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbx, r9\n"
      "setc r9b; spill CF x215 to reg (r9)\n"
      "seto dl; spill OF x269 to reg (rdx)\n"
      "shr r14, 58; x266 <- x263>> 58\n"
      "sar  r13b, 1\n"
      "adcx r10, rax\n"
      "sar  r9b, 1\n"
      "adcx r12, r10\n"
      "sar  r15b, 1\n"
      "adcx r8, r12\n"
      "sar  dl, 1\n"
      "adcx r14, r8\n"
      "imul r11, [ rsi + 0x20 ], 0x2; x13 <- arg1[4] * 0x2\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r13, r9, r11; x98, x97<- arg1[0] * x13\n"
      "mov rdx, rbx; x272, copying x268 here, cause x268 is needed in a reg "
      "for "
      "other than x272, namely all: , x274, x272, size: 2\n"
      "shrd rdx, r14, 58; x272 <- x270||x268 >> 58\n"
      "mov r15, rdx; preserving value of x272 into a new reg\n"
      "mov rdx, [ rsi + 0x10 ]; saving arg1[2] in rdx.\n"
      "mulx rax, r10, [ rsi + 0x10 ]; x72, x71<- arg1[2] * arg1[2]\n"
      "mov rdx, rcx; x14 to rdx\n"
      "mulx rcx, r12, [ rsi + 0x8 ]; x84, x83<- arg1[1] * x14\n"
      "xchg rdx, rbp; x10001, swapping with x14, which is currently in rdx\n"
      "mov [ rsp + 0x68 ], r15; spilling x272 to mem\n"
      "mulx r8, r15, [ rsi + 0x28 ]; x30, x29<- arg1[5] * x10001\n"
      "mov [ rsp + 0x70 ], rbp; spilling x14 to mem\n"
      "mov rbp, rdx; preserving value of x10001 into a new reg\n"
      "mov rdx, [ rsi + 0x30 ]; saving arg1[6] in rdx.\n"
      "mov [ rsp + 0x78 ], rbx; spilling x268 to mem\n"
      "mov [ rsp + 0x80 ], r13; spilling x98 to mem\n"
      "mulx rbx, r13, [ rsp + 0x30 ]; x26, x25<- arg1[6] * x10003\n"
      "test al, al\n"
      "adox r13, r15\n"
      "adcx r13, r10\n"
      "setc dl; spill CF x195 to reg (rdx)\n"
      "clc;\n"
      "adcx r13, r12\n"
      "seto r10b; spill OF x191 to reg (r10)\n"
      "mov r12, -0x2 ; moving imm to reg\n"
      "inc r12; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r13, r9\n"
      "seto r12b; spill OF x203 to reg (r12)\n"
      "mov r9, -0x2 ; moving imm to reg\n"
      "inc r9; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r13, [ rsp + 0x68 ]\n"
      "movzx r10, r10b\n"
      "lea r8, [ r8 + rbx ]\n"
      "lea r8, [ r8 + r10 ]\n"
      "movzx rdx, dl\n"
      "lea rax, [ rax + r8 ]\n"
      "lea rax, [ rax + rdx ]\n"
      "setc r9b; spill CF x199 to reg (r9)\n"
      "seto r15b; spill OF x276 to reg (r15)\n"
      "shr r14, 58; x273 <- x270>> 58\n"
      "sar  r9b, 1\n"
      "adcx rcx, rax\n"
      "sar  r12b, 1\n"
      "adcx rcx, [ rsp + 0x80 ]\n"
      "imul rbx, [ rsi + 0x28 ], 0x2; x12 <- arg1[5] * 0x2\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r10, r9, rbx; x96, x95<- arg1[0] * x12\n"
      "sar  r15b, 1\n"
      "adcx r14, rcx\n"
      "mov rdx, [ rsi + 0x8 ]; arg1[1] to rdx\n"
      "mulx r12, r15, r11; x82, x81<- arg1[1] * x13\n"
      "mov rdx, r13; x279, copying x275 here, cause x275 is needed in a reg "
      "for "
      "other than x279, namely all: , x279, x281, size: 2\n"
      "shrd rdx, r14, 58; x279 <- x277||x275 >> 58\n"
      "mov r8, rdx; preserving value of x279 into a new reg\n"
      "mov rdx, [ rsi + 0x10 ]; saving arg1[2] in rdx.\n"
      "mulx rax, rcx, [ rsp + 0x70 ]; x70, x69<- arg1[2] * x14\n"
      "mov rdx, [ rsi + 0x30 ]; arg1[6] to rdx\n"
      "mov [ rsp + 0x88 ], r13; spilling x275 to mem\n"
      "mov [ rsp + 0x90 ], r10; spilling x96 to mem\n"
      "mulx r13, r10, rbp; x24, x23<- arg1[6] * x10001\n"
      "imul rdx, [ rsp + 0x48 ], 0x2; x10002 <- x4 * 0x2\n"
      "mov [ rsp + 0x98 ], r10; spilling x23 to mem\n"
      "mulx rdx, r10, [ rsi + 0x38 ]; x22, x21<- arg1[7] * x10002\n"
      "test al, al\n"
      "adox r10, [ rsp + 0x98 ]\n"
      "adcx r10, rcx\n"
      "seto cl; spill OF x175 to reg (rcx)\n"
      "mov [ rsp + 0xa0 ], rax; spilling x70 to mem\n"
      "mov rax, -0x2 ; moving imm to reg\n"
      "inc rax; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, r15\n"
      "seto al; spill OF x183 to reg (rax)\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, r9\n"
      "seto r15b; spill OF x187 to reg (r15)\n"
      "mov r9, -0x2 ; moving imm to reg\n"
      "inc r9; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r10, r8\n"
      "setc r9b; spill CF x179 to reg (r9)\n"
      "seto r8b; spill OF x283 to reg (r8)\n"
      "shr r14, 58; x280 <- x277>> 58\n"
      "sar  cl, 1\n"
      "adcx r13, rdx\n"
      "sar  r9b, 1\n"
      "adcx r13, [ rsp + 0xa0 ]\n"
      "sar  al, 1\n"
      "adcx r12, r13\n"
      "imul rdx, [ rsi + 0x30 ], 0x2; x9 <- arg1[6] * 0x2\n"
      "sar  r15b, 1\n"
      "adcx r12, [ rsp + 0x90 ]\n"
      "sar  r8b, 1\n"
      "adcx r14, r12\n"
      "mov rcx, r10; x286, copying x282 here, cause x282 is needed in a reg "
      "for "
      "other than x286, namely all: , x286, x288, size: 2\n"
      "shrd rcx, r14, 58; x286 <- x284||x282 >> 58\n"
      "xchg rdx, rbp; x10001, swapping with x9, which is currently in rdx\n"
      "mulx rdx, r9, [ rsi + 0x38 ]; x20, x19<- arg1[7] * x10001\n"
      "mov rax, rdx; preserving value of x20 into a new reg\n"
      "mov rdx, [ rsi + 0x8 ]; saving arg1[1] in rdx.\n"
      "mulx r15, r8, rbx; x80, x79<- arg1[1] * x12\n"
      "mov rdx, [ rsi + 0x0 ]; arg1[0] to rdx\n"
      "mulx r13, r12, rbp; x94, x93<- arg1[0] * x9\n"
      "mov rdx, [ rsi + 0x18 ]; arg1[3] to rdx\n"
      "mov [ rsp + 0xa8 ], r10; spilling x282 to mem\n"
      "mov [ rsp + 0xb0 ], r15; spilling x80 to mem\n"
      "mulx r10, r15, [ rsi + 0x18 ]; x58, x57<- arg1[3] * arg1[3]\n"
      "xor rdx, rdx\n"
      "adox r9, r15\n"
      "mov r15, rdx; preserving value of 0x0 into a new reg\n"
      "mov rdx, [ rsi + 0x10 ]; saving arg1[2] in rdx.\n"
      "mov [ rsp + 0xb8 ], r9; spilling x158 to mem\n"
      "mov [ rsp + 0xc0 ], rbp; spilling x9 to mem\n"
      "mulx r9, rbp, r11; x68, x67<- arg1[2] * x13\n"
      "adcx rbp, [ rsp + 0xb8 ]\n"
      "seto dl; spill OF x159 to reg (rdx)\n"
      "mov [ rsp + 0xc8 ], r10; spilling x58 to mem\n"
      "mov r10, -0x2 ; moving imm to reg\n"
      "inc r10; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rbp, r8\n"
      "setc r10b; spill CF x163 to reg (r10)\n"
      "seto r8b; spill OF x167 to reg (r8)\n"
      "shr r14, 58; x287 <- x284>> 58\n"
      "mov byte [ rsp + 0xd0 ], r10b; spilling byte x163 to mem\n"
      "xor r10, r10\n"
      "adox rbp, r12\n"
      "movzx rdx, dl\n"
      "lea rax, [ rdx + rax ]\n"
      "adcx rax, [ rsp + 0xc8 ]\n"
      "clc;\n"
      "adcx rbp, rcx\n"
      "movzx r15, byte [ rsp + 0xd0 ]; load byte memx163 to register64\n"
      "lea r9, [ r9 + rax ]\n"
      "lea r9, [ r9 + r15 ]\n"
      "movzx r8, r8b\n"
      "lea r9, [ r8 + r9 ]\n"
      "mov r8, [ rsp + 0xb0 ]\n"
      "lea r9, [r8+r9]\n"
      "adox r13, r9\n"
      "adcx r14, r13\n"
      "mov rcx, rbp; x293, copying x289 here, cause x289 is needed in a reg "
      "for "
      "other than x293, namely all: , x293, x295, size: 2\n"
      "shrd rcx, r14, 58; x293 <- x291||x289 >> 58\n"
      "imul r12, [ rsi + 0x38 ], 0x2; x6 <- arg1[7] * 0x2\n"
      "mov rdx, r12; x6 to rdx\n"
      "mulx r12, r15, [ rsi + 0x0 ]; x92, x91<- arg1[0] * x6\n"
      "mov r8, rdx; preserving value of x6 into a new reg\n"
      "mov rdx, [ rsi + 0x8 ]; saving arg1[1] in rdx.\n"
      "mulx rax, r9, [ rsp + 0xc0 ]; x78, x77<- arg1[1] * x9\n"
      "imul rdx, [ rsp + 0x18 ], 0x2; x10000 <- x1 * 0x2\n"
      "xchg rdx, rbx; x12, swapping with x10000, which is currently in rdx\n"
      "mulx r13, r10, [ rsi + 0x10 ]; x66, x65<- arg1[2] * x12\n"
      "xchg rdx, r11; x13, swapping with x12, which is currently in rdx\n"
      "mov [ rsp + 0xd8 ], r15; spilling x91 to mem\n"
      "mulx rdx, r15, [ rsi + 0x18 ]; x56, x55<- arg1[3] * x13\n"
      "xchg rdx, rbx; x10000, swapping with x56, which is currently in rdx\n"
      "mov [ rsp + 0xe0 ], rax; spilling x78 to mem\n"
      "mulx rdx, rax, [ rsi + 0x40 ]; x18, x17<- arg1[8] * x10000\n"
      "mov [ rsp + 0xe8 ], r8; spilling x6 to mem\n"
      "xor r8, r8\n"
      "adox rax, r15\n"
      "adcx rax, r10\n"
      "seto r10b; spill OF x143 to reg (r10)\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rax, r9\n"
      "setc r15b; spill CF x147 to reg (r15)\n"
      "clc;\n"
      "adcx rax, [ rsp + 0xd8 ]\n"
      "seto r9b; spill OF x151 to reg (r9)\n"
      "mov byte [ rsp + 0xf0 ], r15b; spilling byte x147 to mem\n"
      "mov r15, -0x2 ; moving imm to reg\n"
      "inc r15; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox rax, rcx\n"
      "movzx r10, r10b\n"
      "lea rbx, [ rbx + rdx ]\n"
      "lea rbx, [ rbx + r10 ]\n"
      "setc r15b; spill CF x155 to reg (r15)\n"
      "seto cl; spill OF x297 to reg (rcx)\n"
      "shr r14, 58; x294 <- x291>> 58\n"
      "sar byte [ rsp + 0xf0 ], 1\n"
      "adcx r13, rbx\n"
      "sar  r9b, 1\n"
      "adcx r13, [ rsp + 0xe0 ]\n"
      "sar  r15b, 1\n"
      "adcx r12, r13\n"
      "sar  cl, 1\n"
      "adcx r14, r12\n"
      "imul rdx, [ rsi + 0x40 ], 0x2; x3 <- arg1[8] * 0x2\n"
      "mov r10, rax; x300, copying x296 here, cause x296 is needed in a reg "
      "for "
      "other than x300, namely all: , x302, x300, size: 2\n"
      "shrd r10, r14, 58; x300 <- x298||x296 >> 58\n"
      "mov r9, rdx; preserving value of x3 into a new reg\n"
      "mov rdx, [ rsp + 0xc0 ]; saving x9 in rdx.\n"
      "mulx rdx, r15, [ rsi + 0x10 ]; x64, x63<- arg1[2] * x9\n"
      "xchg rdx, r9; x3, swapping with x64, which is currently in rdx\n"
      "mulx rdx, rcx, [ rsi + 0x0 ]; x90, x89<- arg1[0] * x3\n"
      "mov rbx, rdx; preserving value of x90 into a new reg\n"
      "mov rdx, [ rsp + 0xe8 ]; saving x6 in rdx.\n"
      "mulx rdx, r13, [ rsi + 0x8 ]; x76, x75<- arg1[1] * x6\n"
      "mov r12, rdx; preserving value of x76 into a new reg\n"
      "mov rdx, [ rsi + 0x20 ]; saving arg1[4] in rdx.\n"
      "mov [ rsp + 0xf8 ], r9; spilling x64 to mem\n"
      "mulx r8, r9, [ rsi + 0x20 ]; x46, x45<- arg1[4] * arg1[4]\n"
      "mov rdx, r11; x12 to rdx\n"
      "mulx rdx, r11, [ rsi + 0x18 ]; x54, x53<- arg1[3] * x12\n"
      "add r9, r11; could be done better, if r0 has been u8 as well\n"
      "mov r11, -0x2 ; moving imm to reg\n"
      "inc r11; OF<-0x0, preserve CF (workaround, load -2, increa it, and dont "
      "save it. I this a hack?)\n"
      "adox r9, r15\n"
      "setc r11b; spill CF x127 to reg (r11)\n"
      "clc;\n"
      "adcx r9, r13\n"
      "setc r15b; spill CF x135 to reg (r15)\n"
      "clc;\n"
      "adcx r9, rcx\n"
      "movzx r11, r11b\n"
      "lea rdx, [ rdx + r8 ]\n"
      "lea rdx, [ rdx + r11 ]\n"
      "setc cl; spill CF x139 to reg (rcx)\n"
      "clc;\n"
      "adcx r9, r10\n"
      "setc r10b; spill CF x304 to reg (r10)\n"
      "seto r13b; spill OF x131 to reg (r13)\n"
      "shr r14, 58; x301 <- x298>> 58\n"
      "sar  r13b, 1\n"
      "adcx rdx, [ rsp + 0xf8 ]\n"
      "sar  r15b, 1\n"
      "adcx r12, rdx\n"
      "sar  cl, 1\n"
      "adcx rbx, r12\n"
      "sar  r10b, 1\n"
      "adcx r14, rbx\n"
      "mov r8, r9; x307, copying x303 here, cause x303 is needed in a reg for "
      "other than x307, namely all: , x309, x307, size: 2\n"
      "shrd r8, r14, 57; x307 <- x305||x303 >> 57\n"
      "shr r14, 57; x308 <- x305>> 57\n"
      "add r8, [ rsp + 0x40 ]; could be done better, if r0 has been u8 as "
      "well\n"
      "adc r14, 0x0\n"
      "mov r11, r8; x313, copying x310 here, cause x310 is needed in a reg for "
      "other than x313, namely all: , x313, x314, size: 2\n"
      "shrd r11, r14, 58; x313 <- x312||x310 >> 58\n"
      "mov r13, 0x3ffffffffffffff ; moving imm to reg\n"
      "and rax, r13; x302 <- x296& 0x3ffffffffffffff\n"
      "mov r15, [ rsp + 0x58 ]; x260, copying x254 here, cause x254 is needed "
      "in "
      "a reg for other than x260, namely all: , x260, size: 1\n"
      "and r15, r13; x260 <- x254& 0x3ffffffffffffff\n"
      "lea r11, [ r11 + r15 ]\n"
      "mov rcx, 0x1ffffffffffffff ; moving imm to reg\n"
      "and r9, rcx; x309 <- x303& 0x1ffffffffffffff\n"
      "mov r10, r11; x317, copying x315 here, cause x315 is needed in a reg "
      "for "
      "other than x317, namely all: , x317, x316, size: 2\n"
      "and r10, r13; x317 <- x315& 0x3ffffffffffffff\n"
      "mov rdx, [ rsp + 0x28 ]; load m64 out1 to register64\n"
      "mov [ rdx + 0x40 ], r9; out1[8] = x309\n"
      "shr r11, 58; x316 <- x315>> 58\n"
      "mov r12, [ rsp + 0x60 ]; x267, copying x261 here, cause x261 is needed "
      "in "
      "a reg for other than x267, namely all: , x267, size: 1\n"
      "and r12, r13; x267 <- x261& 0x3ffffffffffffff\n"
      "mov rbx, [ rsp + 0x78 ]; x274, copying x268 here, cause x268 is needed "
      "in "
      "a reg for other than x274, namely all: , x274, size: 1\n"
      "and rbx, r13; x274 <- x268& 0x3ffffffffffffff\n"
      "mov [ rdx + 0x18 ], rbx; out1[3] = x274\n"
      "lea r11, [ r11 + r12 ]\n"
      "mov r14, [ rsp + 0x88 ]; x281, copying x275 here, cause x275 is needed "
      "in "
      "a reg for other than x281, namely all: , x281, size: 1\n"
      "and r14, r13; x281 <- x275& 0x3ffffffffffffff\n"
      "mov [ rdx + 0x20 ], r14; out1[4] = x281\n"
      "and r8, r13; x314 <- x310& 0x3ffffffffffffff\n"
      "mov [ rdx + 0x0 ], r8; out1[0] = x314\n"
      "and rbp, r13; x295 <- x289& 0x3ffffffffffffff\n"
      "mov r15, [ rsp + 0xa8 ]; x288, copying x282 here, cause x282 is needed "
      "in "
      "a reg for other than x288, namely all: , x288, size: 1\n"
      "and r15, r13; x288 <- x282& 0x3ffffffffffffff\n"
      "mov [ rdx + 0x30 ], rbp; out1[6] = x295\n"
      "mov [ rdx + 0x8 ], r10; out1[1] = x317\n"
      "mov [ rdx + 0x28 ], r15; out1[5] = x288\n"
      "mov [ rdx + 0x38 ], rax; out1[7] = x302\n"
      "mov [ rdx + 0x10 ], r11; out1[2] = x318\n"
      "mov rbx, [ rsp + 0x100 ]; restoring from stack\n"
      "mov rbp, [ rsp + 0x108 ]; restoring from stack\n"
      "mov r12, [ rsp + 0x110 ]; restoring from stack\n"
      "mov r13, [ rsp + 0x118 ]; restoring from stack\n"
      "mov r14, [ rsp + 0x120 ]; restoring from stack\n"
      "mov r15, [ rsp + 0x128 ]; restoring from stack\n"
      "add rsp, 0x138 \n"
      "ret\n"
      "; cpu Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz\n"
      "; clocked at 2309 MHz\n"
      "; first cyclecount 9172, last 8509.5\n"
      "; seed 1617678978 \n"
      "; time needed: 14046631 ms / 100000 runs=> 140.46631ms/run\n"
      "; Time spent for assembling and measureing (r=200,e=100): 1929613 ms\n"
      "; Ratio (time for assembling + measure)/(total runtime for 100000runs): "
      "0.1373719434930696\n"
      "; number reverted permutation/ tried permutation: 33438 / 33535 "
      "=0.9971074996272551\n"
      "; number reverted spill/ tried spill: 33108 / 33218 "
      "=0.9966885423565537\n"
      "; number reverted decision/ tried decision: 33157 / 33246 "
      "=0.9973229862239066\n"
      "; FailedEvals (cannot swap because of edge to the next node): 27065\n"};
  // convenience pointer
  void (*err)(measuresuite_t, const char *) =
      error_handling_helper_template_str;

  const int num_batches = 10;
  const int batch_size = 20;

  // INIT
  const int arg_num_out = 1;
  const int chunksize = 0;
  measuresuite_t ms = NULL;
  const uint64_t bounds[] = {
      0xc00000000000000 - 1, 0xc00000000000000 - 1, 0xc00000000000000 - 1,
      0xc00000000000000 - 1, 0xc00000000000000 - 1, 0xc00000000000000 - 1,
      0xc00000000000000 - 1, 0xc00000000000000 - 1, 0x600000000000000 - 1};
  if (ms_measure_init(&ms, arg_width, arg_num_in, arg_num_out, chunksize,
                      bounds, "./liball_fiat.so", symbol)) {
    err(ms, "Failed to measure_init. Reason: %s.");
    return 1;
  }

  // measure
  if (ms_measure(ms, fa, fb, batch_size, num_batches)) {
    err(ms, "Failed to measure. Reason: %s.");
    return 1;
  }
  const char *output = NULL;
  size_t jsonlen = 0;
  ms_getJson(ms, &output, &jsonlen);
  printf("%s\n", output);

  // Require to have true in the string but not false
  if (strstr(output, "true") == NULL && strstr(output, "false") != NULL) {
    fprintf(stderr, "should have been a correct result\n");
    ms_measure_end(ms);
    return 1;
  }
  // END
  if (ms_measure_end(ms)) {
    err(ms, "Failed to measure_end. Reason: %s.");
    return 1;
  }
  return 0;
}
